<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>Component Decomposition</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Lunr -->
<script src="/website/assets/scripts/lunr.min.js"></script>
<!-- JQuery -->
<script src="/website/assets/scripts/jquery.min.js"></script>
<link rel="stylesheet" href="/website/assets/styles/font-awesome.min.css">
<link rel="stylesheet" href="/website/assets/styles/googlecode.min.css">
<script src="/website/assets/scripts/highlight.min.js"></script>
<script src="/website/assets/scripts/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="/website/assets/styles/bootstrap.min.css">

<script src="/website/assets/scripts/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<script src="/website/shared/rightmenu.js"></script>

<!-- ************** Google analytics ************ -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

gtag('consent', 'default', {
  'analytics_storage': 'denied'
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>
<script>
  function consentGranted() {
    gtag('consent', 'update', {
      'analytics_storage': 'granted'
    });
  }
</script>

<!-- ******************************************** -->


</head>
<body class="article">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt=""/>
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="/website/pages/welcome/welcome.html"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="https://www.katacoda.com/devonfw">Tutorials</a></p>
</li>
<li>
<p><a href="/website/pages/solutions/index.html">Solutions</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Docs</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input
      id="search-field"
      type="search"
      class="form-control mr-sm-2"
      placeholder="Search by keyword(s)..."
      aria-label="Search"
      style="height: auto;"
      autocomplete="off"/>
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width=auto height=auto alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="content" class="mt-4 mt-sm-5">
<div class="toc2">
<div class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc">Component Decomposition</a>
<ul class="sectlevel1">
<li><a href="#devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc_defining-components">Defining Components</a></li>
<li><a href="#devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc_defining-state">Defining state</a></li>
<li><a href="#devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc_when-are-dumb-components-needed">When are Dumb Components needed</a></li>
</ul>
</li>
</ul>
<h1 id="devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc" class="sect0">Component Decomposition</h1>
<div class="paragraph">
<p>When implementing a new requirement there are a few design decisions, which need to be considered.
A decomposition in <em>Smart</em> and <em>Dumb Components</em> should be done first.
This includes the definition of state and responsibilities.
Implementing a new dialog will most likely be done by defining a new <em>Smart Component</em> with multiple <em>Dumb Component</em> children.</p>
</div>
<div class="paragraph">
<p>In the component tree this would translate to the definition of a new sub-tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-tree-highlighted-subtree.svg"><img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/component-tree-highlighted-subtree.svg" alt="Component Tree With Highlighted Sub Tree" width="450"></a>
</div>
<div class="title">Figure 1. Component Tree with highlighted sub-tree</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc_defining-components">Defining Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following gives an example for component decomposition.
Shown is a screenshot from a style guide to be implemented.
It is a widget called <code>Listpicker</code>.</p>
</div>
<div class="paragraph">
<p>The basic function is an <code>input</code> field accepting direct input.
So typing <code>otto</code> puts <code>otto</code> inside the <code>FormControl</code>.
With arrow down key or by clicking the icon displayed in the inputs right edge a dropdown is opened.
Inside possible values can be selected and filtered beforehand.
After pressing arrow down key the focus should move into the filter input field.
Up and down arrow keys can be used to select an element from the list.
Typing into the filter input field filters the list from which the elements can be selected.
The current selected element is highlighted with green background color.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-1.svg"><img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/component-decomposition-example-1.svg" alt="Component Decomposition Example 1v2" width="450"></a>
</div>
<div class="title">Figure 2. Component decomposition example before</div>
</div>
<div class="paragraph">
<p>What should be done, is to define small reusable <em>Dumb Components</em>.
This way the complexity becomes manageable.
In the example every colored box describes a component with the purple box being a <em>Smart Component</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-2.svg"><img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/component-decomposition-example-2.svg" alt="Component Decomposition Example 2v2" width="450"></a>
</div>
<div class="title">Figure 3. Component decomposition example after</div>
</div>
<div class="paragraph">
<p>This leads to the following component tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-component-tree.svg"><img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/component-decomposition-example-component-tree.svg" alt="Component Decomposition Example component tree" width="450"></a>
</div>
<div class="title">Figure 4. Component decomposition example component tree</div>
</div>
<div class="paragraph">
<p>Note the uppermost component is a <em>Dumb Component</em>.
It is a wrapper for the label and the component to be displayed inside a form.
The <em>Smart Component</em> is <code>Listpicker</code>.
This way the widget can be reused without a form needed.</p>
</div>
<div class="paragraph">
<p>A widgets is a typical <em>Smart Component</em> to be shared across feature modules.
So the <code>SharedModule</code> is the place for it to be defined.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc_defining-state">Defining state</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every UI has state.
There are different kinds of state, for example</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View State: e.g. is a panel open, a css transition pending, etc.</p>
</li>
<li>
<p>Application State: e.g. is a payment pending, current URL, user info, etc.</p>
</li>
<li>
<p>Business Data: e.g. products loaded from back-end</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is good practice to base the component decomposition on the state handled by a component and to define a simplified state model beforehand.
Starting with the parent - the <em>Smart Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What overall state does the dialog have: e.g. loading, error, valid data loaded, valid input, invalid input, etc.
Every defined value should correspond to an overall appearance of the whole dialog.</p>
</li>
<li>
<p>What events can occur to the dialog: e.g. submitting a form, changing a filter, pressing buttons, pressing keys, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For every <em>Dumb Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What data does a component display: e.g. a header text, user information to be displayed, a loading flag, etc.<br>
This will be a slice of the overall state of the parent <em>Smart Component</em>.
In general a <em>Dumb Component</em> presents a slice of its parent <em>Smart Components</em> state to the user.</p>
</li>
<li>
<p>What events can occur: keyboard events, mouse events, etc.<br>
These events are all handled by its parent <em>Smart Component</em> - every event is passed up the tree to be handled by a <em>Smart Component</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These information should be reflected inside the modeled state.
The implementation is a TypeScript type - an interface or a class describing the model.</p>
</div>
<div class="paragraph">
<p>So there should be a type describing all state relevant for a <em>Smart Component</em>.
An instance of that type is send down the component tree at runtime.
Not every <em>Dumb Component</em> will need the whole state.
For instance a single <em>Dumb Component</em> could only need a single string.</p>
</div>
<div class="paragraph">
<p>The state model for the previous <code>Listpicker</code> example is shown in the following listing.</p>
</div>
<div class="listingblock">
<div class="title">Listing 1. <code>Listpicker</code> state model</div>
<div class="content">
<pre class="highlight"><code class="ts language-ts">export class ListpickerState {

  items: {}[]|undefined;
  columns = ['key', 'value'];
  keyColumn = 'key';
  displayValueColumn = 'value';
  filteredItems: {}[]|undefined;
  filter = '';
  placeholder = '';
  caseSensitive = true;
  isDisabled = false;
  isDropdownOpen = false;
  selectedItem: {}|undefined;
  displayValue = '';

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Listpicker</code> holds an instance of <code>ListpickerState</code> which is passed down the component tree via <code>@Input()</code> bindings in the <em>Dumb Components</em>.
Events emitted by children - <em>Dumb Components</em> - create a new instance of <code>ListpickerState</code> based on the current instance and the event and its data.
So a state transition is just setting a new instance of <code>ListpickerState</code>.
Angular Bindings propagate the value down the tree after exchanging the state.</p>
</div>
<div class="listingblock">
<div class="title">Listing 2. <code>Listpicker</code> State transition</div>
<div class="content">
<pre class="highlight"><code class="ts language-ts">export class ListpickerComponent {

  // initial default values are set
  state = new ListpickerState();

  /** User changes filter */
  onFilterChange(filter: string): void {
    // apply filter ...
    const filteredList = this.filterService.filter(...);

    // important: A new instance is created, instead of altering the existing one.
    //            This makes change detection easier and prevents hard to find bugs.
    this.state = Object.assing({}, this.state, {
      filteredItems: filteredList,
      filter: filter
    });
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Note:</div>
<p>It is not always necessary to define the model as independent type.
So there would be no state property and just properties for every state defined directly in the component class.
When complexity grows and state becomes larger this is usually a good idea.
If the state should be shared between <em>Smart Components</em> a store is to be used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4ts.wiki_angular_guide-component-decomposition.asciidoc_when-are-dumb-components-needed">When are Dumb Components needed</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it is not necessary to perform a full decomposition. The architecture does not enforce it generally. What you should keep in mind is, that there is always a point when it becomes recommendable.</p>
</div>
<div class="paragraph">
<p>For example a template with 800 line of code is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>not understandable</p>
</li>
<li>
<p>not maintainable</p>
</li>
<li>
<p>not testable</p>
</li>
<li>
<p>not reusable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So when implementing a template with more than 50 line of code you should think about decomposition.</p>
</div>
</div>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc_introduction.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_introduction-why-should-i-use-devonfw.asciidoc.html">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc_further-information.html">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_ide.wiki_devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_general_master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script src="/website/assets/scripts/popper.min.js"></script>
    <script src="/website/assets/scripts/bootstrap.min.js"></script>
<div class="footnote"><sub>

Last updated 2022-03-29 13:42:18 UTC
</sub></div>
</div>
</div>
<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script async src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
<script>
      let cookieName = 'cookie_consent';
      let expiryTime = new Date(2037, 11, 21);
      let today = new Date();
      let cookieConsentDeclinedDate = localStorage.getItem("cookie_consent_declined");
      let dateDiffHours = 0;
      let cookieConsentHtml = `
      <div id="cookie-consent">
        <p>
          We use cookies to perform analytics and enhance user experience. Do you accept to the use of cookies?
        </p>
        <p class="cookie-consent-buttons">
          <a id="decline-cookie-btn" class="btn white-button" href="javascript:void(0)">Decline</a>
          <a id="accept-cookie-btn" class="btn blue-button" href="javascript:void(0)">Accept</a>
        </p>
      </div>
      `;
      dateDiffHours = cookieConsentDeclinedDate ? Math.abs(cookieConsentDeclinedDate - today) / 36e5 : 0;
      if (document.cookie.indexOf(cookieName) < 0) {
        if (cookieConsentDeclinedDate) {
          if (dateDiffHours > 24) {
            $("body").append(cookieConsentHtml);
          }
        } else {
          $("body").append(cookieConsentHtml);
        }
      }
      $("#accept-cookie-btn").click(function() {
        document.cookie = `${cookieName}=accept;expires=${expiryTime};path=/`;
        localStorage.removeItem("cookie_consent_declined");
        consentGranted();
        $("#cookie-consent").hide();
      });
      $("#decline-cookie-btn").click(function() {
        localStorage.setItem("cookie_consent_declined", today);
        $("#cookie-consent").hide();
      });
</script>
</body>
</html>