<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>Provisioning Platforms</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Lunr -->
<script src="/website/assets/scripts/lunr.min.js"></script>
<!-- JQuery -->
<script src="/website/assets/scripts/jquery.min.js"></script>
<link rel="stylesheet" href="/website/assets/styles/font-awesome.min.css">
<link rel="stylesheet" href="/website/assets/styles/googlecode.min.css">
<script src="/website/assets/scripts/highlight.min.js"></script>
<script src="/website/assets/scripts/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="/website/assets/styles/bootstrap.min.css">

<script src="/website/assets/scripts/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<script src="/website/shared/rightmenu.js"></script>

<!-- ************** Google analytics ************ -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

gtag('consent', 'default', {
  'analytics_storage': 'denied'
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>
<script>
  function consentGranted() {
    gtag('consent', 'update', {
      'analytics_storage': 'granted'
    });
  }
</script>

<!-- ******************************************** -->


</head>
<body class="article">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt=""/>
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="/website/pages/welcome/welcome.html"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="#header_https://www.katacoda.com/devonfw">Tutorials</a></p>
</li>
<li>
<p><a href="/website/pages/solutions/index.html">Solutions</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Docs</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input
      id="search-field"
      type="search"
      class="form-control mr-sm-2"
      placeholder="Search by keyword(s)..."
      aria-label="Search"
      style="height: auto;"
      autocomplete="off"/>
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width=auto height=auto alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="content" class="mt-4 mt-sm-5">
<div class="sect1">
<h2 id="solutions_includes_provisioning_platforms_index.asciidoc_provisioning-platforms">Provisioning Platforms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="solutions_includes_provisioning_platforms_index.asciidoc_azure">Azure</h3>
<div class="sect3">
<h4 id="solutions_includes_provisioning_platforms_index.asciidoc_overview">Overview</h4>
<div class="paragraph">
<p>This chapter lists major features/ concrete services for provisioning of the Azure platform. This architecture pattern builds on the general problem description for monitoring. The picture below summarizes major services and concepts that are discussed in detail in the next chpater.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/provisioning_azure.png" alt="Provisioning Azure Overview" width="966" height="526">
</div>
</div>
</div>
<div class="sect3">
<h4 id="solutions_includes_provisioning_platforms_index.asciidoc_automation-code">Automation code</h4>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_modelling-environments">Modelling Environments</h5>
<div class="paragraph">
<p>Azure provides the following structural elements to model an environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Resource groups:</strong> Smallest possible container</p>
</li>
<li>
<p><strong>Subscriptions:</strong> One subscription can contain many resource groups. With a subscription discounts for dev/ test environments are possible.</p>
</li>
<li>
<p><strong>Management groups:</strong> One management group can contain many subscriptions. They can be used enforce policies across subscriptions if environments share common characteristics.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An environment can be linked to another environment. Linking an environment to multiple environment is beneficial for addressing cross concerns such as monitoring (Similar to Hub/ Spoke topology in networks).</p>
</div>
</div>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_pipeline-implementation">Pipeline Implementation</h5>
<div class="paragraph">
<p>The programming approach can be either UI driven or <strong>programmatic</strong>. Pipeline programming languages such as YAML structure the actions to be performed by the pipeline and provide basic mechansims such as downloading code from the repo, parameter handling, stating triggers and triggering other programming languages. These other languages are then used to setup infrastructure such as terraform or deploying application code.</p>
</div>
<div class="paragraph">
<p>Azure allows to <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/build/triggers?view=azure-devops"><strong>trigger</strong> pipelines</a> upon:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a push to repo</p>
</li>
<li>
<p>a pull request to repo</p>
</li>
<li>
<p>a schedule</p>
</li>
<li>
<p>a pipeline completion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The platform allows to <strong>pass parameters</strong> by various mechanisms to pipelines(Explicit per user input, programmatically). Parameters can be passed by group identifier or explicitly as key value pairs. Complex structured objects as known from object programming languages are not directly possible (Require parsing of files with object structure). Parametrization might be constrained by the used service in certain areas.</p>
</div>
<div class="paragraph">
<p>The platform provides <strong>support for quality gates</strong> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Static code analysis</p>
<div class="paragraph">
<p>Microsoft does not provide own tools for static code analysis but allows integration of others.</p>
</div>
</li>
<li>
<p>Automated tests (Unit, Integration, End-To-End)</p>
<div class="paragraph">
<p>Microsoft provides services that include test management e.g. creating test suites with test cases and getting an overview about the results.</p>
</div>
</li>
<li>
<p>Approval</p>
<div class="paragraph">
<p>Azure services support approval for a certain environments and enforcing pull requests as quality gates.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Azure platform provides the following basic options to <strong>store</strong> automation code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Services that provide repositories</p>
</li>
<li>
<p>Integration of various external code repositories</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_orchestration">Orchestration</h5>
<div class="paragraph">
<p>To <strong>orchestrate</strong> pipelines the two following basic mechanisms can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implicit Chaining</p>
<div class="paragraph">
<p>In that case the complete workflow is not explicitly coded in a dedicated pipeline. Pipelines are chained implicitly by triggering events. The biggest problem with that approach is the missing single pane of control. The current state in the overall workflow is for instance only implicitly given by the currently running pipeline.</p>
</div>
</li>
<li>
<p>Creating a dedicated orchestration pipeline</p>
<div class="paragraph">
<p>An additional pipeline triggers in this scenario other pipelines acting as building blocks. Pipelines can run separately (just run the deployment) or as part of a bigger workflow (e.g. create environment from scratch).</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Orchestration must take dependencies into account. They might result from the deployed code or the scope of the pipeline (scope is e.g. a single microservice and code includes the libraries neede).
Orchestrated pipelines must pass data between them. The recommended method is to use key vault.</p>
</div>
<div class="paragraph">
<p><strong>Recreation of resources in short intervals</strong> can cause pipelines to fail since the previously deleted resource still exists in the background.(Even although soft delete is not applicable). Whether Azure really deleted everything depends on the service. For instance Azure API management seemed to be affected by that problem.</p>
</div>
</div>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_traceability">Traceability</h5>
<div class="paragraph">
<p><strong>Traceability</strong> requires an identifier for referencing artefacts. A standard schema is a semantic version. The platform only supports partial support for number generation such as <a href="https://ychetankumarsarma.medium.com/build-versioning-in-azure-devops-pipelines-94b5a79f80a0">incrementing numbers</a>. Linking the code in the repo to a certain version depends on used repository.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="solutions_includes_provisioning_platforms_index.asciidoc_infrastructure-application-code">Infrastructure/ Application code</h4>
<div class="paragraph">
<p>A <strong>programming language</strong> is either "declarative" or "imperative". Declarative programming languages state the target state and it is the job of the declarative programming language how to get there. The following rules are applied to achieve that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create a resource if not there</p>
</li>
<li>
<p>update an existing resource if different properties</p>
</li>
<li>
<p>delete resource if not there</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Imperative programming languages state the how. The internal delta calculation needs to be explicitly programmed here. If possible declarative programming languages are recommended due to automatic delta calculation. Typical case is infrastructure.</p>
</div>
<div class="paragraph">
<p>Typical declarative options are shown in detail in the table below. The overall recommendation is to go for terraform. Major reasons for downvoting Bicep/ ARM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ARM: difficult readability for humans</p>
</li>
<li>
<p>Bicep: Lack of support for testing based on plan and testing ecosystem since first added recently.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Table with declarative programming language options:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Criteria</th>
<th class="tableblock halign-left valign-top">Bicep</th>
<th class="tableblock halign-left valign-top">ARM</th>
<th class="tableblock halign-left valign-top">Terraform</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same syntax across clouds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- (Azure Only)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- (Azure Only)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (multi)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">What if</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (no complete prop list;only display of plan; unexpected delete)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- (not available)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (plan command)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detection current</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (Real anaylsis but time)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (Real anaylsis)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (Statefile)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testing/ static analysis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (Only via ARM)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (available)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (available)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Human Readability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reverse Engineering</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- (Extra ARM step + adjust)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (adjust)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (Direct via Terraformer)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latest features</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (No embedded fallback)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ (native)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">o (Time lag but embedded fallback)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The major options for imperative programming languages are Azure CLI, Powershell (Windows) or Linux based scripting. Azure CLI is recommended as prefered choice since it works on linux and windows based VMs.</p>
</div>
<div class="paragraph">
<p>The created resources should follow a <strong>uniform naming schema</strong>. This requires naming to be factored out in a centralized module. Terraform supports factoring out common code in modules. However the backend must already exist and should also follow a naming convention. The recommendation is therefore to expose the common terraform module via an additional path that does not require a backend to determine the names for the azure resources representing the backend.</p>
</div>
</div>
<div class="sect3">
<h4 id="solutions_includes_provisioning_platforms_index.asciidoc_provisioning">Provisioning</h4>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_organizational-mapping">Organizational Mapping</h5>
<div class="paragraph">
<p>The provisioning must match the organizational requirements of your organization. Azure provides services to model sub units within your organization such as departments, projects and teams.</p>
</div>
</div>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_integration">Integration</h5>
<div class="paragraph">
<p>Platform allows a modular approach to outsource certain functionality to third party software such as code repository. Which parts is service specific.</p>
</div>
<div class="paragraph">
<p>External tools providing pipelines can be integrated in two conceptual ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Trigger automation pipelines from external:</strong> This involves the configuration of a CI pipeline in the external tool such as Jenkins and mechanism in the automation service that invokes the CI process when source code is pushed to a repository or a branch.</p>
</li>
<li>
<p><strong>Run external pipelines from within the platform:</strong> In this approach automation reaches out to an external tool to work with the results.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_configuration">Configuration</h5>
<div class="paragraph">
<p>Configuration for provisioning is required in various areas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Environment:</strong> E.g. name of resource group per potential target environment</p>
</li>
<li>
<p><strong>Repository:</strong> E.g. relevant repos/ branching</p>
</li>
<li>
<p><strong>Pipelines:</strong> Parameters pipelines run with such as the technical user name or settings required by the built/ deployed code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Concrete features used for the above three points depend on the used services. A general storage for sensitive data (keys, secrets, certificates) in Azure is always Azure Key Vault.</p>
</div>
</div>
<div class="sect4">
<h5 id="solutions_includes_provisioning_platforms_index.asciidoc_compliance">Compliance</h5>
<div class="paragraph">
<p>The standard concept for role-based access controls is called RBAC in Azure. It assigns principals (humans or technical accounts) permissions for a certain resource. Regarding provisioning the following users are relevant:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Technical user (service principal) the pipelines are running with</p>
</li>
<li>
<p>Users for administrating the provisioning service</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Azure Active Directory is the central service in Azure that defines and controls all principals (human/ service) per tenant.</p>
</div>
<div class="paragraph">
<p>Granularity of roles that can be granted depend on the service. The boundaries in which users exist or permissions can be assigned is also service specific.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc_introduction.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc_introduction.html#introduction-why-should-i-use-devonfw.asciidoc">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc_further-information.html">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
<li>
<p><a href="/website/pages/resources/resources.html">Resources</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-ide-support.asciidoc.html#LICENSE.asciidoc">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script src="/website/assets/scripts/popper.min.js"></script>
    <script src="/website/assets/scripts/bootstrap.min.js"></script>
<div class="footnote"><sub>

Last updated 2022-03-07 18:40:56 UTC
</sub></div>
</div>
</div>
<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script async src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
<script>
      let cookieName = 'cookie_consent';
      let expiryTime = new Date(2037, 11, 21);
      let today = new Date();
      let cookieConsentDeclinedDate = localStorage.getItem("cookie_consent_declined");
      let dateDiffHours = 0;
      let cookieConsentHtml = `
      <div id="cookie-consent">
        <p>
          We use cookies to perform analytics and enhance user experience. Do you accept to the use of cookies?
        </p>
        <p class="cookie-consent-buttons">
          <a id="decline-cookie-btn" class="btn white-button" href="javascript:void(0)">Decline</a>
          <a id="accept-cookie-btn" class="btn blue-button" href="javascript:void(0)">Accept</a>
        </p>
      </div>
      `;
      dateDiffHours = cookieConsentDeclinedDate ? Math.abs(cookieConsentDeclinedDate - today) / 36e5 : 0;
      if (document.cookie.indexOf(cookieName) < 0) {
        if (cookieConsentDeclinedDate) {
          if (dateDiffHours > 24) {
            $("body").append(cookieConsentHtml);
          }
        } else {
          $("body").append(cookieConsentHtml);
        }
      }
      $("#accept-cookie-btn").click(function() {
        document.cookie = `${cookieName}=accept;expires=${expiryTime};path=/`;
        localStorage.removeItem("cookie_consent_declined");
        consentGranted();
        $("#cookie-consent").hide();
      });
      $("#decline-cookie-btn").click(function() {
        localStorage.setItem("cookie_consent_declined", today);
        $("#cookie-consent").hide();
      });
</script>
</body>
</html>