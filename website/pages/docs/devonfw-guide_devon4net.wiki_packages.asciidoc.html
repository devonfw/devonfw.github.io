<!DOCTYPE html><html lang="en"><head><style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style><style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Updated at 2022-06-16 10:31:28 UTC">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>devonfw guide</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Lunr -->
<script src="/website/assets/scripts/lunr.min.js"></script>
<!-- JQuery -->
<script src="/website/assets/scripts/jquery.min.js"></script>
<link rel="stylesheet" href="/website/assets/styles/font-awesome.min.css">
<link rel="stylesheet" href="/website/assets/styles/googlecode.min.css">
<script src="/website/assets/scripts/highlight.min.js"></script>
<script src="/website/assets/scripts/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="/website/assets/styles/bootstrap.min.css">

<script src="/website/assets/scripts/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<script src="/website/shared/rightmenu.js"></script>

<!-- ************** Google analytics ************ -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

gtag('consent', 'default', {
  'analytics_storage': 'denied'
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>
<script>
  function consentGranted() {
    gtag('consent', 'update', {
      'analytics_storage': 'granted'
    });
  }
</script>

<!-- ******************************************** -->


</head>
<body id="devonfw-guide_master.asciidoc" class="book toc2 toc-left">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt="">
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="/website/pages/welcome/welcome.html"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="https://www.katacoda.com/devonfw">Tutorials</a></p>
</li>
<li>
<p><a href="/website/pages/solutions/index.html">Solutions</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html" class="active">Docs</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input id="search-field" type="search" class="form-control mr-sm-2" placeholder="Search by keyword(s)..." aria-label="Search" style="height: auto;" autocomplete="off">
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width="auto" height="auto" alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="header">
<h1>devonfw guide</h1>
<div class="details">
<span id="author" class="author">Updated at 2022-06-16 10:38:43 UTC</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="master.html">devonfw guide</a></span></p><ul class="sectlevel0">
<li><a href="devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting Started</a>
</li>
<li><a href="devonfw-guide_ide.wiki_devonfw-ide.asciidoc.html">devonfw-ide</a>
</li>
<li><a href="devonfw-guide_devon4j.wiki_devon4j.asciidoc.html">Java</a>
</li>
<li><a href="devonfw-guide_devon4ng.wiki_master-devon4ng.asciidoc.html">Angular</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc.html">.net</a>
<ul class="sectlevel1">
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_architecture-basics.html">Architecture basics</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_user-guide.html">User guide</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_how-to-section.html">How To section</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_cobigen-guide.html">Cobigen guide</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_coding-conventions.html">Coding conventions</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_environment.html">Environment</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_packages.html">Packages</a>
<ul class="sectlevel2">
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html"><span class="toc-current">Packages</span></a>
<ul class="sectlevel3">
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_overview">Overview</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_configuration-basics">Configuration basics</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.circuitbreaker">Devon4Net.Infrastructure.CircuitBreaker</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.swagger">Devon4Net.Infrastructure.Swagger</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.logger">Devon4Net.Infrastructure.Logger</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.cors">Devon4Net.Infrastructure.Cors</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.jwt">Devon4Net.Infrastructure.JWT</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.litedb">Devon4Net.Infrastructure.LiteDb</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.fluentvalidation">Devon4Net.Infrastructure.FluentValidation</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.common">Devon4Net.Infrastructure.Common</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.extensions">Devon4Net.Infrastructure.Extensions</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.mediatr">Devon4Net.Infrastructure.MediatR</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.rabbitmq">Devon4Net.Infrastructure.RabbitMQ</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.middleware">Devon4Net.Infrastructure.Middleware</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html#devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.unitofwork">Devon4Net.Infrastructure.UnitOfWork</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_templates.html">Templates</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_samples.html">Samples</a>
</li>
</ul>
</li>
<li><a href="devonfw-guide_devon4node.wiki_master-devon4node.asciidoc.html">NodeJS</a>
</li>
<li><a href="devonfw-guide_general_db_master-database.asciidoc.html">Choosing your Database</a>
</li>
<li><a href="devonfw-guide_devonfw-guide_master.asciidoc_2.html">Tools</a>
</li>
<li><a href="devonfw-guide_devonfw-guide_master.asciidoc_3.html">Architecture</a>
</li>
<li><a href="devonfw-guide_devonfw-guide_master.asciidoc_4.html">CI/CD</a>
</li>
<li><a href="devonfw-guide_general_master-contributing.asciidoc.html">Contributing</a>
</li>
<li><a href="devonfw-guide_general_master-release-notes.asciidoc.html">Release Notes</a>
</li>
</ul>
</div>
</div><div id="content">
<div class="sect2">
<h3 id="devonfw-guide_devon4net.wiki_packages.asciidoc">Packages</h3>
<!-- toc disabled -->
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_overview">Overview</h4>
<div class="paragraph">
<p>Devon4Net is made up of several components, all of which are described in this document. This components are available in the form of NuGet packages. In the <a href="https://github.com/devonfw/devon4net">Devon4Net repository</a> this packages are placed in the Infrastructure layer which is a cross-cutting layer that can be referenced from any level on the architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Infrastructure_package.png" alt="Infrastructure package">
</div>
<div class="title">Figure 107. Infrastructure directory</div>
</div>
<div class="paragraph">
<p>Components are class librarys that collaborate with each other for a purpose. They group the necessary code so that they can work according to the specified configuration. For example, the package <code>Devon4Net.Infrastructure.Swagger</code> has isolated the swagger essential pieces of code and has been developed in such a manner that you just need to write a few lines and specify a couple options to get it working the way you need.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_component-structure">Component structure</h5>
<div class="paragraph">
<p>All of the components follow a similar structure which includes the next directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Configuration:</strong> Static configuration class (or multiple classes) that contains extension methods used to configure the component.</p>
</li>
<li>
<p><strong>Handlers:</strong> Classes that are required to manage complex operations or communications.</p>
</li>
<li>
<p><strong>Helpers:</strong> Normally static classes that help in small conversions and operations.</p>
</li>
<li>
<p><strong>Constants:</strong> Classes that contain static constants to get rid of hard-coded values.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Because each component is unique, you may find some more directories or less than tose listed above.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_configuration-basics">Configuration basics</h4>
<div class="paragraph">
<p>Any configuration for .Net Core 6.0 projects needs to be done in the <code>Program.cs</code> files which is placed on the startup application, but we can extract any configuration needed to an extension method and call that method from the component. As a result, the component will group everything required and the configuration will be much easier.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_extension-methods">Extension methods</h5>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods">Extension methods</a> allow you to "add" methods to existing types without having to create a new derived type, or modify it in any way. Although they are static methods, they are referred to as instance methods on the extended type. For C# code, there is no difference in calling a extension method and a method defined in a type.</p>
</div>
<div class="paragraph">
<p>For example, the next extension method will extend the class <code>ExtendedClass</code> and it will need an <code>OptionalParameter</code> instance to do some configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public static class ExtensionMethods
{
    public static void DoConfiguration(this ExtendedClass class,  OptionalParameter extra)
    {
        // Do your configuration here
        class.DoSomething();
        class.AddSomething(extra)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Thanks to the <code>this</code> modifier preceeding the first parameter, we are able to call the method directly on a instance of <code>ExtendedClass</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">ExtendedClass class = new();
OptionalParameter extra = new();

class.DoConfiguration(extra);</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, we don’t need that a class derived from <code>ExtendedClass</code> to add some methods and we don’t need those methods placed in the class itself either. This can be seen easily when extending a primitive type such as <code>string</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public static class ExtensionMethods
{
    public static int CountWords(this string word,  char[] separationChar = null)
    {
        if(separationChar == null) separationChar = new char[]{' '};
        return word.Split(separationChar, StringSplitOptions.RemoveEmptyEntries).Length;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous example we created a method that can count words given a list of separation characters. And now we can use it over any string as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">string s = "Hello World";
Console.WriteLine(s.CountWords());</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-output" data-lang="output">2</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember to reference the class so you can use the extension methods (<code>using</code> directive).
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_options-pattern">Options pattern</h5>
<div class="paragraph">
<p>The <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-6.0">options design pattern</a> allows you to have strong typed options and provides you the ability to inject them into your services. To follow this pattern, the configuration present on the <code>appsettings.json</code> needs to be mapped into an object.</p>
</div>
<div class="paragraph">
<p>This means, the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"essentialoptions" : {
  "value1": "Hello",
  "value2": "World"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Would need the following class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class EssentialOptions
{
    public string Value1 { get; set; }
    public string Value2 { get; set; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In .Net we can easily map the configuration thanks to the <code>Configure&lt;T&gt;()</code> method from <code>IServiceCollection</code> and <code>GetSection()</code> method from <code>IConfiguration</code>. We could be loading the configuration as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">services.Configure&lt;EssentialOptions&gt;(configuration.GetSection("essentialoptions"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then injecting it making use of <code>IOptions&lt;T&gt;</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class MyService : IMyService
{
    private readonly EssentialOptions _options;

    public MyService(IOptions&lt;EssentialOptions&gt; options)
    {
        _options = options.Value;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In devon4net, there is an <code>IServiceCollection</code> extension available that uses the methods described above and also returns the options injected thanks to <code>IOptions&lt;T&gt;</code>.  So, to load the same options, we should use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">EssentialOptions options = services.GetTypedOptions&lt;EssentialOptions&gt;(configuration, "essentialoptions");</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_dependency-injection">Dependency Injection</h5>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/core/extensions/dependency-injection">Dependency Injection</a> is a technique for achieving Inversion of Control Principle. In .Net it is a built-in part that comes with the framework.</p>
</div>
<div class="paragraph">
<p>Using a service provider <code>IServiceProvider</code> available in .Net, we are able to add any service or option to a service stack that will be available for injection in constructors of the classes where it’s used.</p>
</div>
<div class="paragraph">
<p>Services can be registered with one of the following lifetimes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Lifetime</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Example</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transient lifetime services are created each time they’re requested from the service container. Disposed at the end of the request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">services.AddTransient&lt;IDependency, Dependency&gt;();</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scoped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A scoped lifetime indicates that services are created once per client request (connection).  Disposed at the end of the request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">services.AddScoped&lt;IDependency, Dependency&gt;();</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Singleton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Singleton lifetime services are created either the first time they’re requested or by the developer. Every subsequent request of the service implementation from the dependency injection container uses the same instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">services.AddSingleton&lt;IDependency, Dependency&gt;();</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This injections would be done in the startup project in <code>Program.cs</code> file, and then injected in constructors where needed.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.circuitbreaker">Devon4Net.Infrastructure.CircuitBreaker</h4>
<div class="paragraph">
<p>The Devon4Net.Infrastructure.CircuitBreaker component implements the retry pattern for HTTP/HTTPS calls. It may be used in both SOAP and REST services.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration">Configuration</h5>
<div class="paragraph">
<p>Component configuration is made on file <code>appsettings.{environment}.json</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"CircuitBreaker": {
    "CheckCertificate": false,
    "Endpoints": [
      {
        "Name": "SampleService",
        "BaseAddress": "http://localhost:5001",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": false,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "Tls12", //Tls, Tls11,Tls12, Tls13, none
        "CompressionSupport": true,
        "AllowAutoRedirect": true
      }
    ]
  }</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CheckCertificate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True if HTTPS is required. This is useful when developing an API Gateway needs a secured HTTP, disabling this on development we can use communications with a valid server certificate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Endpoints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array with predefined sites to connect with</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name key to identify the destination URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Headers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not ready yet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WaitAndRetrySeconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array which determines the number of retries and the lapse period between each retry. The value is in milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ceritificate client to use to perform the HTTP call</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CertificatePassword</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password that you assign when exporting the certificate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SslProtocol</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The secure protocol to use on the call</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_packages.asciidoc_protocols">Protocols</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Protocol</strong></th>
<th class="tableblock halign-left valign-top"><strong>Key</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSl3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the Secure Socket Layer (SSL) 3.0 security protocol. SSL 3.0 has been superseded by the Transport Layer Security (TLS) protocol and is provided for backward compatibility only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">192</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the Transport Layer Security (TLS) 1.0 security protocol. The TLS 1.0 protocol is defined in IETF RFC 2246.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">768</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the Transport Layer Security (TLS) 1.1 security protocol. The TLS 1.1 protocol is defined in IETF RFC 4346. On Windows systems, this value is supported starting with Windows 7.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3072</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the Transport Layer Security (TLS) 1.2 security protocol. The TLS 1.2 protocol is defined in IETF RFC 5246. On Windows systems, this value is supported starting with Windows 7.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12288</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the TLS 1.3 security protocol. The TLS protocol is defined in IETF RFC 8446.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure it in the <code>appsettings.Development.json</code> file.</p>
</div>
<div class="paragraph">
<p>Add it using Dependency Injection on this case we instanciate Circuit Breaker in a Service Sample Class</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">public class SampleService: Service&lt;SampleContext&gt;, ISampleService
    {
        private readonly ISampleRepository _sampleRepository;
        private IHttpClientHandler _httpClientHandler { get; }

        /// &lt;summary&gt;
        /// Constructor
        /// &lt;/summary&gt;
        /// &lt;param name="uoW"&gt;&lt;/param&gt;
        public SampleService(IUnitOfWork&lt;SampleContext&gt; uoW, IHttpClientHandler httpClientHandler) : base(uoW)
        {
            _httpClientHandler = httpClientHandler;
            _sampleRepository = uoW.Repository&lt;ISampleRepository&gt;();
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the necessary references.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">using Devon4Net.Infrastructure.CircuitBreaker.Common.Enums;
using Devon4Net.Infrastructure.CircuitBreaker.Handlers;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must give the following arguments to make a POST call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">await _httpClientHandler.Send&lt;YourOutPutClass&gt;(HttpMethod.POST, NameOfTheService, EndPoint, InputData, MediaType.ApplicationJson);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">YourOutputClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the class that you are expecting to retrieve from the call</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NameOftheService</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The key name of the endpoint provided in the appsettings.json file at Endpoints[] node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EndPoint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Part of the url to use with the base address. E.g: <em>/validate</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>InputData</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Your instance of the class with values that you want to use in the call</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MediaType.ApplicationJson</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The media type flag for the call</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Install-Package Devon4Net.Infrastructure.CircuitBreaker</code></pre>
</div>
</div>
<div class="paragraph">
<p>next add via Dependency Injection the circuit breaker instance.On this case we use a Service</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">public class SampleService : ISampleService
 {
   private IHttpClientHandler _httpClientHandler { get; }

    public SampleService(IHttpClientHandler httpClientHandler)
      {
        _httpClientHandler = httpClientHandler;
      }
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Don’t forget to provide the necessary references.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">using Devon4Net.Infrastructure.CircuitBreaker.Common.Enums;
using Devon4Net.Infrastructure.CircuitBreaker.Handlers;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And configure CircuitBreaker in <code>Program.cs</code> adding the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">using Devon4Net.Infrastructure.CircuitBreaker;
.
.
.
builder.Services.SetupCircuitBreaker(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must add the default configuration shown in the configuration section and at this point you can use the circuit breaker functionality in your code.</p>
</div>
<div class="paragraph">
<p>To perform a GET call you should use your circuit breaker instance as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">await _httpClientHandler.Send&lt;YourOutPutClass&gt;(HttpMethod.Get, NameOfTheService, EndPoint, InputData, MediaType.ApplicationJson);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">YourOutputClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the class that you are expecting to retrieve from the call</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NameOftheService</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The key name of the endpoint provided in the appsettings.json file at Endpoints[] node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EndPoint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Part of the url to use with the base address. E.g: <em>/validate</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>InputData</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Your instance of the class with values that you want to use in the call</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MediaType.ApplicationJson</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The media type flag for the call</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.swagger">Devon4Net.Infrastructure.Swagger</h4>
<div class="paragraph">
<p>Swagger is a set of open source software tools for designing, building, documenting, and using RESTful web services. This component provides a full externalized configuration for the Swagger tool.</p>
</div>
<div class="paragraph">
<p>It primarily provides the swagger UI for visualizing and testing APIs, as well as automatic documentation generation via annotations in controllers.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_5">Configuration</h5>
<div class="paragraph">
<p>Component configuration is made on file <code>appsettings.{environment}.json</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"Swagger": {
    "Version": "v1",
    "Title": "My Swagger API",
    "Description": "Swagger API for devon4net documentation",
    "Terms": "https://www.devonfw.com/terms-of-use/",
    "Contact": {
      "Name": "devonfw",
      "Email": "sample@mail.com",
      "Url": "https://www.devonfw.com"
    },
    "License": {
      "Name": "devonfw - Terms of Use",
      "Url": "https://www.devonfw.com/terms-of-use/"
    },
    "Endpoint": {
      "Name": "V1 Docs",
      "Url": "/swagger/v1/swagger.json",
      "UrlUi": "swagger",
      "RouteTemplate": "swagger/v1/{documentName}/swagger.json"
    }
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following list all the configuration fields are described:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Version</code>: Actual version of the API.</p>
</li>
<li>
<p><code>Title</code>: Title of the API.</p>
</li>
<li>
<p><code>Description</code>: Description of the API.</p>
</li>
<li>
<p><code>Terms</code>: Link to the terms and conditions agreement.</p>
</li>
<li>
<p><code>Contact</code>: Your contact information.</p>
</li>
<li>
<p><code>License</code>: Link to the License agreement.</p>
</li>
<li>
<p><code>Endpoint</code>: Swagger endpoints information.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_6">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure it in the <code>appsettings.{environment}.json</code> file.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_7">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; install-package Devon4Net.Infrastructure.Swagger</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure swagger in <code>Program.cs</code> adding the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Infrastructure.Swagger;
.
.
.
builder.Services.SetupSwagger(builder.Configuration);
.
.
.
app.ConfigureSwaggerEndPoint();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the default configuration shown in the configuration section.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_tips">Tips</h5>
<div class="ulist">
<ul>
<li>
<p>In order to generate the documentation annotate your actions with summary, remarks and response tags:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>/// &lt;summary&gt;
/// Method to make a reservation with potential guests. The method returns the reservation token.
/// &lt;/summary&gt;
/// &lt;param name="bookingDto"&gt;&lt;/param&gt;
/// &lt;response code="201"&gt;Ok.&lt;/response&gt;
/// &lt;response code="400"&gt;Bad request. Parser data error.&lt;/response&gt;
/// &lt;response code="401"&gt;Unauthorized. Authentication fail.&lt;/response&gt;
/// &lt;response code="403"&gt;Forbidden. Authorization error.&lt;/response&gt;
/// &lt;response code="500"&gt;Internal Server Error. The search process ended with error.&lt;/response&gt;
[HttpPost]
[HttpOptions]
[Route("/mythaistar/services/rest/bookingmanagement/v1/booking")]
[AllowAnonymous]
[EnableCors("CorsPolicy")]
public async Task&lt;IActionResult&gt; Booking([FromBody]BookingDto bookingDto)
{
    try
    {

    ...</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can access the swagger UI on <code><a href="http://localhost:yourport/swagger/index.html" class="bare">http://localhost:yourport/swagger/index.html</a></code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.logger">Devon4Net.Infrastructure.Logger</h4>
<div class="paragraph">
<p>Previously known as Devon4Net.Infrastructure.Log(v5.0 or lower)</p>
</div>
<div class="paragraph">
<p>Logging is an essential component of every application’s life cycle.
A strong logging system becomes a critical component that assists developers to understand and resolve emerging problems.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Starting with .NET 6, logging services no longer register the ILogger type. When using a logger, specify the generic-type alternative ILogger&lt;TCategoryName&gt; or register the <code>ILogger</code> with dependency injection (DI).
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Default .Net log levels system:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to notify failures that force the program to shut down</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to track major faults that occur during program execution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to report non-critical unexpected behavior</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informative messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Debug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for debugging messages containing additional information about application operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For tracing the code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you choose this option the loggin category will not write any messages</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_9">Configuration</h5>
<div class="paragraph">
<p>Component setup is done in the <code>appsettings.{environment}.json</code> file using the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  "Logging": {
    "UseLogFile": true,
    "UseSQLiteDb": true,
    "UseGraylog": true,
    "UseAOPTrace": false,
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    },
    "SqliteDatabase": "logs/log.db",
    "LogFile": "logs/{0}_devonfw.log",
    "SeqLogServerHost": "http://127.0.0.1:5341",
    "GrayLog": {
      "GrayLogHost": "127.0.0.1",
      "GrayLogPort": "12201",
      "GrayLogProtocol": "UDP",
      "UseSecureConnection": true,
      "UseAsyncLogging": true,
      "RetryCount": 5,
      "RetryIntervalMs": 15,
      "MaxUdpMessageSize": 8192
    }
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>UseLogFile</code>: When you set this option to true, you can store the log output to a file.</p>
</li>
<li>
<p><code>UseSQLiteDb</code>: True when you wish to insert the log output into a SQLiteDb</p>
</li>
<li>
<p><code>UseGrayLog</code>: This option enables the use of GrayLog for loggin</p>
</li>
<li>
<p><code>UseAOPTrace</code>: True if you need to trace the attributes of the controllers</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Don’t set to true on production environments, doing so may expose critical information.
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LogLevel</code>: Sets the minimum level of logs to be captured</p>
</li>
<li>
<p><code>SqliteDatabase</code>: path to SQlite database</p>
</li>
<li>
<p><code>LogFile</code>: path to the log file</p>
</li>
<li>
<p><code>SeqLogServerHost</code>: url for Seq server, you need to install Seq  in order to use it, you can install it clicking <a href="https://datalust.co/download">here</a></p>
</li>
<li>
<p><code>GrayLog</code>: Some configuration parameters for Graylog service you can install it using <a href="https://www.graylog.org/products/open-source#download-open">this link</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_10">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure it in the <code>appsettings.Development.json</code> file.</p>
</div>
<div class="paragraph">
<p>You can use the methods implemented in Devon4NetLogger class, each method corresponds with a log level in .Net log levels system, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">Devon4NetLogger.Debug("Executing GetTodo from controller TodoController");</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_11">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Devon4Net.Infrastructure.Logger</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following line of code to Progam.cs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupLog(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the default configuration shown in the configuration section.</p>
</div>
<div class="paragraph">
<p>use the Devon4NetLogger class methods as explanied above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">Devon4NetLogger.Information("Executing GetSample from controller SampleController");</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.cors">Devon4Net.Infrastructure.Cors</h4>
<div class="paragraph">
<p>Allows CORS settings for the devon4Net application.
Configuration may be used to configure several domains.
Web clients (for example, Angular) must follow this rule to avoid performing AJAX calls to another domain.</p>
</div>
<div class="paragraph">
<p>Cross-Origin Resource Sharing (CORS) is an HTTP-header-based mechanism that allows a server to specify any origin (domain, scheme, or port) outside of its own from which a browser should allow resources to be loaded. CORS also makes use of a process in which browsers send a "preflight" request to the server hosting the cross-origin resource to ensure that the server will allow the actual request. During that preflight, the browser sends headers indicating the HTTP method as well as headers that will be used in the actual request.</p>
</div>
<div class="paragraph">
<p>You may find out more by going to <a href="https://docs.microsoft.com/es-es/aspnet/core/security/cors?view=aspnetcore-6.0">Microsoft CORS documentation</a></p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_12">Configuration</h5>
<div class="paragraph">
<p>Component setup is done in the <code>appsettings.{environment}.json</code> file using the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json"> "Cors": //[], //Empty array allows all origins with the policy "CorsPolicy"
  [
    {
      "CorsPolicy": "CorsPolicy",
      "Origins": "http://localhost:4200,https://localhost:4200,http://localhost,https://localhost;http://localhost:8085,https://localhost:8085",
      "Headers": "accept,content-type,origin,x-custom-header,authorization",
      "Methods": "GET,POST,HEAD,PUT,DELETE",
      "AllowCredentials": true
    }
  ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may add as many policies as you like following the JSON format. for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json"> "Cors": //[], //Empty array allows all origins with the policy "CorsPolicy"
  [
    {
      "CorsPolicy": "FirstPolicy",
      "Origins": "http://localhost:4200",
      "Headers": "accept,content-type,origin,x-custom-header,authorization",
      "Methods": "GET,POST,DELETE",
      "AllowCredentials": true
    },
    {
      "CorsPolicy": "SecondPolicy",
      "Origins": "https://localhost:8085",
      "Headers": "accept,content-type,origin",
      "Methods": "GET,POST,HEAD,PUT,DELETE",
      "AllowCredentials": false
    }
  ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following table all the configuration fields are described:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Property</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CorsPolicy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the policy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Origins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The origin’s url that you wish to accept.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Headers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permitted request headers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Http methods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowCredentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set true to allow the exchange of credentials across origins</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_13">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure it in the <code>appsettings.Development.json</code> file.</p>
</div>
<div class="paragraph">
<p>You can enable CORS per action, per controller, or globally for all Web API controllers in your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add this annotation in the Controller Class you want to use CORS policy</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[EnableCors("CorsPolicy")]</code></pre>
</div>
</div>
<div class="paragraph">
<p>As an example, consider this implementation on the EmployeeController class</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">namespace Devon4Net.Application.WebAPI.Implementation.Business.EmployeeManagement.Controllers
{
    /// &lt;summary&gt;
    /// Employees controller
    /// &lt;/summary&gt;
    [ApiController]
    [Route("[controller]")]
    [EnableCors("CorsPolicy")]
    public class EmployeeController: ControllerBase
    {
      .
      .
      .
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above enables CORS for all the controller methods.</p>
</div>
</li>
<li>
<p>In the same way, you may enable CORS on any controller method:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[EnableCors("FirstPolicy")]
public async Task&lt;ActionResult&gt; GetEmployee()
{

}

public async Task&lt;ActionResult&gt; ModifyEmployee(EmployeeDto employeeDto)
{

}

[EnableCors("SecondPolicy")]
public async Task&lt;ActionResult&gt; Delete([Required]long employeeId)
{

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above enables CORS for the GetEmployee and Delete method.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_14">Setting up in other projects</h5>
<div class="paragraph">
<p>Using the Package Manager Console, install the the next package on your solution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Devon4Net.Infrastructure.Cors</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following lines of code to Progam.cs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupCors(builder.Configuration);
.
.
.
app.SetupCors();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the default configuration shown in the configuration section.</p>
</div>
<div class="paragraph">
<p>You can enable CORS per action, per controller, or globally for all Web API controllers in your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add this annotation to the controller class that will be using the CORS policy.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[EnableCors("SamplePolicy")]
    public class SampleController: ControllerBase
    {
      .
      .
      .
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where "SamplePolicy" is the name you give the Policy in the <code>appsettings.{environment}.json</code>.</p>
</div>
<div class="paragraph">
<p>The example above enables CORS for all the controller methods.</p>
</div>
</li>
<li>
<p>In the same way, you may enable any CORS-policy on any controller method:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[EnableCors("FirstPolicy")]
public async Task&lt;ActionResult&gt; GetSample()
{

}

public async Task&lt;ActionResult&gt; Modify(SampleDto sampleDto)
{

}

[EnableCors("SecondPolicy")]
public async Task&lt;ActionResult&gt; Delete([Required]long sampleId)
{

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above enables CORS for the GetSample and Delete method.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_tips_15">Tips</h5>
<div class="ulist">
<ul>
<li>
<p>If you specify the CORS in the <code>appsettings.{environment}.json</code> configuration file as empty array, a default CORS-policy will be used with all origins enabled:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json"> "Cors": [], //Empty array allows all origins with the policy "CorsPolicy"</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Only use this policy in development environments
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This default CORS-policy is defined as "CorsPolicy," and it should be enabled on the Controller Class as a standard Policy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[EnableCors("CorsPolicy")]
public IActionResult Index() {
    return View();
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>if you want to disable the CORS check use the following annotation on any controller method:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[DisableCors]
public IActionResult Index() {
    return View();
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If you set the EnableCors attribute at more than one scope, the order of precedence is:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Action</p>
</li>
<li>
<p>Controller</p>
</li>
<li>
<p>Global</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.jwt">Devon4Net.Infrastructure.JWT</h4>
<div class="quoteblock">
<blockquote>
JSON Web Token (JWT) is an open standard (<a href="https://datatracker.ietf.org/doc/html/rfc7519">RFC 7519</a>) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. JWTs can be signed using a secret (with the <code>HMAC</code> algorithm) or a public/private key pair using <code>RSA</code> or <code>ECDSA</code> .
</blockquote>
<div class="attribution">
— <a href="https://jwt.io/introduction/">What is JSON Web Token?</a>
</div>
</div>
<div class="paragraph">
<p>In other words, a JSON Web Token is a JSON object encoded into an encrypted <code>string</code> that can be decoded and verified making use of cryptographic methods and algorithms. This tokens are mostly used to authenticate users in the context of websites, web applications and web services, but they can also be used to securely exchange information between parties.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_16">Configuration</h5>
<div class="paragraph">
<p>Component configuration is made on file <code>appsettings.{environment}.json</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"JWT": {
    "Audience": "devon4Net",
    "Issuer": "devon4Net",
    "ValidateIssuerSigningKey": true,
    "ValidateLifetime": true,
    "RequireSignedTokens": true,
    "RequireExpirationTime": true,
    "RequireAudience": true,
    "ClockSkew": 5,
    "Security": {
      "SecretKeyEncryptionAlgorithm": "",
      "SecretKey": "",
      "Certificate": "",
      "CertificatePassword": "",
      "CertificateEncryptionAlgorithm": "",
      "RefreshTokenEncryptionAlgorithm": ""
    }
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following list all the configuration fields are described:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Audience</code>: Represents a valid audience that will be used to check against the token’s audience.</p>
</li>
<li>
<p><code>Issuer</code>: Represents a valid issuer that will be used to check against the token’s issuer.</p>
</li>
<li>
<p><code>ValidateIssuerSigningKey</code>: Boolean that controls if validation of the SecurityKey that signed the securityToken is called.</p>
</li>
<li>
<p><code>ValidateLifetime</code>: Boolean to control if the lifetime will be validated during token validation.</p>
</li>
<li>
<p><code>RequireSignedTokens</code>: Boolean that indicates wether a security token has to be signed oe not.</p>
</li>
<li>
<p><code>RequireExpirationTime</code>: Boolean that tells the handler if tokens need an expiration time specified or not.</p>
</li>
<li>
<p><code>RequireAudience</code>: Boolean that indicates tokens need to have an audience specified to be valid or not.</p>
</li>
<li>
<p><code>ClockSkew</code>: Expiration time in minutes.</p>
</li>
<li>
<p><code>Security</code>: Certificate properties will be found in this part.</p>
<div class="ulist">
<ul>
<li>
<p><code>SecretKeyEncryptionAlgorithm</code>: Algorithm used to encrypt the secret key. If no argument is specified, <code>HmacSha512</code> is used.</p>
</li>
<li>
<p><code>SecretKey</code>: Private key used to sign with the certificates. This key will be encrypted and hashed using the specified algorithm.</p>
</li>
<li>
<p><code>Certificate</code>: Name of certificate file or its path (if it is not in the same directory). If it doesn’t exist an exception will be raised.</p>
</li>
<li>
<p><code>CertificatePassword</code>: Password for the certificate selected.</p>
</li>
<li>
<p><code>CertificateEncryptionAlgorithm</code>: Algorithm used to encrypt the certificate. If no argument is specified, <code>HmacSha512</code> is used.</p>
</li>
<li>
<p><code>RefreshTokenEncryptionAlgorithm</code>: Algorithm used to encrypt the refresh token. If no argument is specified, <code>HmacSha512</code> is used.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are two ways of using and creating tokens:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Secret key: A key to encrypt and decrypt the tokens is specified. This key will be encrypted using the specified algorithm.</p>
</li>
<li>
<p>Certificates: A certificate is used to manage token encryption and decryption.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Because the secret key takes precedence over the other option, JWT with the secret key will be used if both configurations are supplied.
</td>
</tr>
</tbody></table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_packages.asciidoc_encryption-algorithms">Encryption algorithms</h6>
<div class="paragraph">
<p>The supported and tested algorithms are the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Algorithm</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HmacSha256</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HS256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HmacSha384</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HS384</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HmacSha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HS512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HmacSha256Signature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.w3.org/2001/04/xmldsig-more#hmac-sha256" class="bare">http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HmacSha384Signature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.w3.org/2001/04/xmldsig-more#hmac-sha384" class="bare">http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HmacSha512Signature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.w3.org/2001/04/xmldsig-more#hmac-sha512" class="bare">http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For the refresh token encryption algorithm you will be able to use any algoritm from the previous table and the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Algorithm</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MD5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Sha</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You will need to specify the name of the algorithm (shown in 'algorithm' column) when configuring the component.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please check <a href="https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/wiki/Supported-Algorithms">Windows Documentation</a> to get the latest updates on supported encryption algorithms.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_17">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template configure it in the <code>appsettings.{environment}.json</code> file.</p>
</div>
<div class="paragraph">
<p>You will need to add a certificate that will be used for signing the token, please check the documentation about how to create a new certificate and add it to a project if you are not aware of how it’s done.</p>
</div>
<div class="paragraph">
<p>Remember to configure your certificates in the JWT configuration.</p>
</div>
<div class="paragraph">
<p>Navigate to <code>Devon4Net.Application.WebAPI.Implementation.Business.AuthManagement.Controllers</code>. There you will find <code>AuthController</code> sample class which is responsible of generating the token thanks to login method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public AuthController(IJwtHandler jwtHandler)
{
    JwtHandler = jwtHandler;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see how the <code>IJwtHandler</code> is injected in the constructor via its interface, which allows you to use its methods.</p>
</div>
<div class="paragraph">
<p>In the following piece of code, you will find how the client token is created using a variety of claims. In this case this end-point will be available to not identified clients thanks to the <code>AllowAnonymous</code> attribute. The client will also have a sample role asigned, depending on which it will be able to access some end-points and not others.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[AllowAnonymous]
.
.
.
var token = JwtHandler.CreateClientToken(new List&lt;Claim&gt;
{
    new Claim(ClaimTypes.Role, AuthConst.DevonSampleUserRole),
    new Claim(ClaimTypes.Name,user),
    new Claim(ClaimTypes.NameIdentifier,Guid.NewGuid().ToString()),
});

return Ok(new LoginResponse { Token = token });</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example will require clients to have the sample role to be able to use the end-point, thanks to the attribute <code>Authorize</code> with the <code>Roles</code> value specified.</p>
</div>
<div class="paragraph">
<p>It also shows how you can obtain information directly from the token using the <code>JwtHandler</code> injection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[Authorize(AuthenticationSchemes = AuthConst.AuthenticationScheme, Roles = AuthConst.DevonSampleUserRole)]
.
.
.
//Get claims
var token = Request.Headers["Authorization"].ToString().Replace($"{AuthConst.AuthenticationScheme} ", string.Empty);
.
.
.
// Return result with claims values
var result = new CurrentUserResponse
{
    Id = JwtHandler.GetClaimValue(userClaims, ClaimTypes.NameIdentifier),
    UserName = JwtHandler.GetClaimValue(userClaims, ClaimTypes.Name),
    CorporateInfo = new List&lt;CorporateBasicInfo&gt;
    {
        new CorporateBasicInfo
        {
            Id = ClaimTypes.Role,
            Value = JwtHandler.GetClaimValue(userClaims, ClaimTypes.Role)
        }
    }
};

return Ok(result);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please check devon documentation of Security and Roles to learn more about method attributtes.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_18">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; install-package Devon4Net.Infrastructure.JWT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure swagger in <code>Program.cs</code> adding the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Application.WebAPI.Configuration;
.
.
.
builder.Services.SetupJwt(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this moment you’ll need to have at least one certificate added to your project.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please read the documentation of how to create and add certificates to a project.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Now we will configure the JWT component in <code>appsettings.{environment}.json</code> as shown in the next piece of code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"JWT": {
    "Audience": "devon4Net",
    "Issuer": "devon4Net",
    "ValidateIssuerSigningKey": true,
    "ValidateLifetime": true,
    "RequireSignedTokens": true,
    "RequireExpirationTime": true,
    "RequireAudience": true,
    "ClockSkew": 5,
    "Security": {
      "SecretKeyLengthAlgorithm": "",
      "SecretKeyEncryptionAlgorithm": "",
      "SecretKey": "",
      "Certificate": "localhost.pfx",
      "CertificatePassword": "12345",
      "CertificateEncryptionAlgorithm": "HmacSha512",
      "RefreshTokenEncryptionAlgorithm": "Sha"
    }
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>For using it, you will need a method that provides you a token. So lets create an <code>AuthController</code> controller and add those methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[Route("api/[controller]")]
[ApiController]
public class AuthController : ControllerBase
{
    private readonly IJwtHandler _jwtHandler;

    public AuthController(IJwtHandler jwtHandler)
    {
        _jwtHandler = jwtHandler;
    }

    [HttpGet]
    [Route("/Auth")]
    [AllowAnonymous]
    public IActionResult GetToken()
    {
        var token = _jwtHandler.CreateClientToken(new List&lt;Claim&gt;
        {
            new Claim(ClaimTypes.Role, "MyRole"),
            new Claim(ClaimTypes.Name, "MyName"),
            new Claim(ClaimTypes.NameIdentifier, Guid.NewGuid().ToString()),
        });
        return Ok(token);
    }

    [HttpGet]
    [Route("/Auth/CheckToken")]
    [Authorize(AuthenticationSchemes = "Bearer", Roles = "MyRole")]
    public IActionResult CheckToken()
    {
        var token = Request.Headers["Authorization"].ToString().Replace($"Bearer ", string.Empty);
        var userClaims = _jwtHandler.GetUserClaims(token).ToList();
        var result = new
        {
            Id = _jwtHandler.GetClaimValue(userClaims, ClaimTypes.NameIdentifier),
            UserName = _jwtHandler.GetClaimValue(token, ClaimTypes.Name),
            Role = _jwtHandler.GetClaimValue(userClaims, ClaimTypes.Role)
        };
        return Ok(result);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reading the code of this controller you have to take in mind a few things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>IJwtHandler</code> class is injected via dependency injection.</p>
<div class="ulist">
<ul>
<li>
<p><code>string CreateClientToken(List&lt;Claim&gt; list)</code> will allow you to create the token through a list of claims. The claims shown are hard-coded examples.</p>
</li>
<li>
<p><code>List&lt;Claim&gt; GetUserClaims(string token)</code> will allow you to get a list of claims given a token.</p>
</li>
<li>
<p><code>string GetClaimValue(List&lt;Claim&gt; list, string claim)</code> will allow you to get the value given the ClaimType and either a list of claims or a token thanks to the <code>string GetClaimValue(string token, string claim)</code> overload.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>[AllowAnonymous]</code> attribute will allow access any client without authentication.</p>
</li>
<li>
<p><code>[Authorize(AuthenticationSchemes = "Bearer", Roles = "MyRole")]</code> attribute will allow any client authenticated with a bearer token and the role <code>"MyRole"</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_references">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.identitymodel.tokens.tokenvalidationparameters?view=azure-dotnet">TokenValidationParameterClass - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/attributes/">Attributtes in C# - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/wiki/Supported-Algorithms">Algorithms supported</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.litedb">Devon4Net.Infrastructure.LiteDb</h4>
<div class="paragraph">
<p><a href="https://www.litedb.org/">LiteDb</a> is an open-source NoSQL embedded database for .NET. Is a document store inspired by MongoDB database. It stores data in documents, which are JSON objects containing key-value pairs. It uses BSON which is a Binary representation of JSON with additional type information.</p>
</div>
<div class="paragraph">
<p>One of the advantages of using this type of NoSQL database is that it allows the use of asynchronous programming techniques following ACID properties on its transactions. This properties are: Atomicity, Consistency, Isolation and Durability, and they ensure the highest possible data reliability and integrity. This means that you will be able to use <code>async/await</code> on your operations.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_20">Configuration</h5>
<div class="paragraph">
<p>The component configuration can be done in <code>appsettings.{environment}.json</code> with the following section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"LiteDb": {
  "EnableLiteDb": true,
  "DatabaseLocation": "devon4net.db"
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EnableLiteDb</code>: Boolean to activate the use of LiteDb.</p>
</li>
<li>
<p><code>DatabaseLocation</code>: Relative path of the file containing all the documents.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_21">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4Net WebApi template just configure it in the <code>appsettings.Development.json</code>.</p>
</div>
<div class="paragraph">
<p>Then you will need to inject the repositories. For that go to <code>Devon4Net.Application.WebAPI.Implementation.Configuration.DevonConfiguration</code> and add the folowing lines in <code>SetupDependencyInjection</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Infrastructure.LiteDb.Repository;
.
.
.
services.AddTransient(typeof(IRepository&lt;&gt;), typeof(Repository&lt;&gt;));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can use the <code>IRepository&lt;T&gt;</code> by injecting it wherever you want to use it. <code>T</code> will be the entity you will be working with in the repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">private readonly IRepository&lt;Todo&gt; _todoRepository;

public TodoController(IRepository&lt;Todo&gt; todoRepository)
{
    _todoRepository = todoRepository;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_22">Setting up in other projects</h5>
<div class="paragraph">
<p>For setting it up in other projects install it running the followin command in the Package Manager Console, or using the Package Manager in Visual Studio:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Devon4Net.Infrastructure.LiteDb</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now set the configuration in the <code>appsettings.{enviroment}.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"LiteDb": {
  "EnableLiteDb": true,
  "DatabaseLocation": "devon_database.db"
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember to set <code>EnableLiteDb</code> to <code>true</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Navigate to your <code>Program.cs</code> file and add the following line to configure the component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Application.WebAPI.Configuration;
.
.
.
builder.Services.SetupLiteDb(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need also to add the repositories you will be using to your services, either by injecting the generic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.AddTransient(typeof(IRepository&lt;&gt;), typeof(Repository&lt;&gt;));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or by choosing to inject them one by one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.AddTransient&lt;IRepository&lt;WeatherForecast&gt;, Repository&lt;WeatherForecast&gt;&gt;();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you will be able to use the repositories in your class using dependency injection, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[ApiController]
[Route("[controller]")]
public class WeatherForecastController : ControllerBase
{
    private readonly IRepository&lt;WeatherForecast&gt; _weatherForecastRepository;

    public WeatherForecastController(IRepository&lt;WeatherForecast&gt; weatherForecastRepository)
    {
        _weatherForecastRepository = weatherForecastRepository;
    }

    [HttpGet]
    public IEnumerable&lt;WeatherForecast&gt; Get()
    {
        return _weatherForecastRepository.Get();
    }

    [HttpPost]
    public IEnumerable&lt;WeatherForecast&gt; PostAndGetAll(WeatherForecast weatherForecast)
    {
        _weatherForecastRepository.Create(weatherForecast);
        return _weatherForecastRepository.Get();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.fluentvalidation">Devon4Net.Infrastructure.FluentValidation</h4>
<div class="paragraph">
<p>Validation is an automatic check to ensure that data entered is sensible and feasible.
It is critical to add validation for data inputs when programming.
This avoids unexpected or anomalous data from crashing your application and from obtaining unrealistic garbage outputs.</p>
</div>
<div class="paragraph">
<p>In the following table some validation methods are described:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Validation Method</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Range check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks if the data is inside a given range.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks that the data entered is of an expected type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Length check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks the number of characters meets expectations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Presence check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks that the user has at least inputted something</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check digit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An additional digit added to a number that is computed from the other digits; this verifies that the remainder of the number has been input correctly.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>FluentValidation is a.NET library that allows users to create strongly-typed validation rules.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_23">Setting up in Devon</h5>
<div class="paragraph">
<p>To establish a set of validation criteria for a specific object, build a class that inherits from <code>CustomFluentValidator&lt;T&gt;</code>, where <code>T</code> is the type of class to validate. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class EmployeeFluentValidator : CustomFluentValidator&lt;Employee&gt;
    {
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where Employee is the class to validate.</p>
</div>
<div class="paragraph">
<p>Create a constructor for this class that will handle validation exceptions, and override the CustomValidate() method from the <code>CustomFluentValidator&lt;T&gt;</code> class to include the validation rules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class EmployeeFluentValidator : CustomFluentValidator&lt;Employee&gt;
    {
        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name="launchExceptionWhenError"&gt;&lt;/param&gt;
        public EmployeeFluentValidator(bool launchExceptionWhenError) : base(launchExceptionWhenError)
        {
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        public override void CustomValidate()
        {
            RuleFor(Employee =&gt; Employee.Name).NotNull();
            RuleFor(Employee =&gt; Employee.Name).NotEmpty();
            RuleFor(Employee =&gt; Employee.SurName).NotNull();
            RuleFor(Employee =&gt; Employee.Surname).NotEmpty();
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we want Employee entity to not accept Null or empty data.
We can notice this error if we do not enter the needed data:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/fluent-validation-error.png" alt="fluent validation error">
</div>
<div class="title">Figure 108. Fluent Validation exceptions</div>
</div>
<div class="paragraph">
<p>We can also develop Custom Validators by utilizing the Predicate Validator to define a custom validation function.
In the example above we can add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> RuleFor(x =&gt; x.Todos).Must(list =&gt; list.Count &lt; 10)
      .WithMessage("The list must contain fewer than 10 items");</code></pre>
</div>
</div>
<div class="paragraph">
<p>This rule restricts the Todo List from having more than ten items.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information about Validators (Rules, Custom Validators, etc…​) please refer to this <a href="https://docs.fluentvalidation.net/en/latest/built-in-validators.html">link</a>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_24">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Devon4Net.Infrastructure.FluentValidation</code></pre>
</div>
</div>
<div class="paragraph">
<p>Follow the instructions described in the previous section.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_references_25">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://fluentvalidation.net/">FluentValidation Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.common">Devon4Net.Infrastructure.Common</h4>
<div class="paragraph">
<p>Library that contains common classes to manage the web api template configuration.</p>
</div>
<div class="paragraph">
<p>The main classes are described in the table below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Folder</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Classes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AutoRegisterData.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the data supplied between the various stages of the AutoRegisterDi extension methods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Http</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProtocolOperation.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains methods to obtain the Http or Tls protocols</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FileOperations.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains methods for managing file operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constants</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AuthConst.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default values for AuthenticationScheme property in the JwtBearerAuthenticationOptions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enums</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MediaType.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static class providing constants for different media types for the CircuitBreaker Handlers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exceptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HttpCustomRequestException.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public class that enables to create Http Custom Request Exceptions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exceptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IWebApiException.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface for webapi exceptions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Handlers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OptionsHandler.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class with a method for retrieving the configuration of the components implementing the <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-6.0">options pattern</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helpers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AutoRegisterHelpers.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the extension methods for registering classes automatically</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helpers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">StaticConstsHelper.cs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assists in the retrieval of an object’s value through reflection</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_options-pattern_26">Options pattern</h5>
<div class="paragraph">
<p>The options pattern uses classes to provide strongly typed access to groups of related settings.</p>
</div>
<div class="paragraph">
<p>It is usually preferable to have a group of related settings packed together in a highly typed object rather than simply a plain key-value pair collection.</p>
</div>
<div class="paragraph">
<p>For the other hand strong typing will always ensure that the configuration settings have the required data types.</p>
</div>
<div class="paragraph">
<p>Keeping related settings together ensures that the code meets two crucial design criteria: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/tutorials/oop">encapsulation</a> and <a href="https://docs.microsoft.com/en-us/dotnet/architecture/modern-web-apps-azure/architectural-principles#:~:text=Separation%20of%20concerns&amp;text=This%20principle%20asserts%20that%20software,to%20make%20them%20more%20noticeable">separation of concerns</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you require more information of the options pattern, please see <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-6.0">the official Microsoft documentation.</a>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>On this component, we have an <strong>Options folder</strong> that has the classes with all the attributes that store all of the configuration parameters.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.extensions">Devon4Net.Infrastructure.Extensions</h4>
<div class="paragraph">
<p>Miscellaneous extension library which contains :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ObjectTypeHelper</p>
</li>
<li>
<p>JsonHelper</p>
</li>
<li>
<p>GuidExtension</p>
</li>
<li>
<p>HttpContextExtensions</p>
</li>
<li>
<p>HttpRequestExtensions</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_objecttypehelper">ObjectTypeHelper</h5>
<div class="paragraph">
<p>Provides a method for converting an instance of an object in the type of an object of a specified class name.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_jsonhelper-json-serializer">JsonHelper (Json Serializer)</h5>
<div class="paragraph">
<p>Serialization is the process of transforming an object’s state into a form that can be saved or transmitted.
Deserialization is the opposite of serialization in that it transforms a stream into an object.
These procedures, when combined, allow data to be stored and transferred.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More information about serializacion may be found in the official <a href="https://docs.microsoft.com/en-us/dotnet/standard/serialization/">Microsoft documentation.</a>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This helper is used in the devon4net components <code>CircuitBreaker</code>, <code>MediatR</code>, and <code>RabbitMQ</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_guidextension">GuidExtension</h5>
<div class="paragraph">
<p>This class has basic methods for managing GUIDs. Some devon4net components, such as <code>MediatR</code> or <code>RabbitMQ</code>, implement it in their Backup Services.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_httpcontextextensions">HttpContextExtensions</h5>
<div class="paragraph">
<p>Provides methods for managing response headers for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TryAddHeader</code> method is used on <code>devon4Net.Infrastructure.Middleware</code> component to add automatically response header options such authorization.</p>
</li>
<li>
<p><code>TryRemoveHeader</code> method is used on <code>devon4Net.Infrastructure.Middleware</code> component to remove automatically response header such AspNetVersion header.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_httprequestextensions">HttpRequestExtensions</h5>
<div class="paragraph">
<p>Provides methods for obtaining Culture and Language information from a <code>HttpRequest</code> object.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_27">Configuration</h5>
<div class="paragraph">
<p>Install the package on your solution via Package Manager Console by running the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">Install-Package devon4Net.Infrastructure.Extensions</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.mediatr">Devon4Net.Infrastructure.MediatR</h4>
<div class="paragraph">
<p>This component employs the <code>MediatR</code> library, which is a tool for implementing CQRS and Mediator patterns in .Net.
<code>MediatR</code> handles the decoupling of the in-process sending of messages from handling messages.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_patterns">Patterns</h5>
<div class="ulist">
<ul>
<li>
<p>Mediator pattern:</p>
<div class="paragraph">
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/microservice-application-layer-implementation-web-api">mediator pattern</a> is a behavioral design pattern that aids in the reduction of object dependencies. The pattern prevents the items from communicating directly with one another, forcing them to collaborate only through a mediator object. Mediator is used to decrease the communication complexity between multiple objects or classes. This pattern offers a mediator class that manages all communications between distinct classes and allows for easy code maintenance through loose coupling.</p>
</div>
</li>
<li>
<p>CQRS pattern:</p>
<div class="paragraph">
<p>The acronym <a href="https://docs.microsoft.com/en-us/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/apply-simplified-microservice-cqrs-ddd-patterns">CQRS</a> stands for Command and Query Responsibility Segregation, and it refers to a design that separates read and update processes for data storage.
By incorporating CQRS into your application, you may improve its performance, scalability, and security.
The flexibility gained by moving to CQRS enables a system to grow more effectively over time and prevents update instructions from triggering merge conflicts at the domain level.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CQRS.png" alt="CQRS">
</div>
<div class="title">Figure 109. CQRS Diagram</div>
</div>
<div class="paragraph">
<p>In this figure, we can see how we may implement this design by utilizing a Relational Database for Write operations and a <a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/materialized-view">Materialized view</a> of this Database that is synchronized and updated via events.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_key-classes">Key Classes</h5>
<div class="paragraph">
<p>In <code>MediatR</code>, you build a basic class that is identified as an implementation of the IRequest or IAsyncRequest interface.
All of the properties that are required to be in the message will be defined in your message class.</p>
</div>
<div class="paragraph">
<p>In the case of this component the messages are created in the <code>ActionBase&lt;T&gt;</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class ActionBase&lt;T&gt; : IRequest&lt;T&gt; where T : class
    {
        public DateTime Timestamp { get; }
        public string MessageType { get; }
        public Guid InternalMessageIdentifier { get; }

        protected ActionBase()
        {
            Timestamp = DateTime.Now;
            InternalMessageIdentifier = Guid.NewGuid();
            MessageType = GetType().Name;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>ActionBase&lt;T&gt;</code> class is then inherited by the <code>CommandBase&lt;T&gt;</code> and <code>QueryBase&lt;T&gt;</code> classes.</p>
</div>
<div class="paragraph">
<p>Now that we’ve built a request message, we can develop a handler to reply to any messages of that type. We must implement the <code>IRequestHandler</code> or <code>IAsyncRequestHandler</code> interfaces, describing the input and output types.</p>
</div>
<div class="paragraph">
<p>In the case of this component <code>MediatrRequestHandler&lt;TRequest, TResponse&gt;</code> abstract class is used for making this process generecic</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public abstract class MediatrRequestHandler&lt;TRequest, TResponse&gt; : IRequestHandler&lt;TRequest, TResponse&gt; where TRequest : IRequest&lt;TResponse&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This interface defines a single method called Handle, which returns a Task of your output type.
This expects your request message object as an argument. In the <code>MediatrRequestHandler&lt;TRequest, TResponse&gt;</code> class has been implemented in this way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public async Task&lt;TResponse&gt; Handle(TRequest request, CancellationToken cancellationToken)
        {
            MediatrActions status;
            TResponse result = default;
            try
            {
                result = await HandleAction(request, cancellationToken).ConfigureAwait(false);
                status = MediatrActions.Handled;
            }
            catch (Exception ex)
            {
                Devon4NetLogger.Error(ex);
                status = MediatrActions.Error;
            }
            await BackUpMessage(request, status).ConfigureAwait(false);
            return result;
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>HandleAction</code> method is defined in the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public abstract Task&lt;TResponse&gt; HandleAction(TRequest request, CancellationToken cancellationToken);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method should be overridden in the application’s business layer Handlers.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_30">Configuration</h5>
<div class="paragraph">
<p>Component configuration is made on file <code>appsettings.{environment}.json</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  "MediatR": {
    "EnableMediatR": true,
    "Backup": {
      "UseLocalBackup": true,
      "DatabaseName": "devon4netMessageBackup.db"
    }
  },</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Property</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnableMediatR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True for enabling the use of MediatR component</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UseLocalBackup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True for using a LiteDB database as a local backup for the <code>MediatR</code> messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the LiteDB database</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_31">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure it in the <code>appsettings.Development.json</code> file.</p>
</div>
<div class="paragraph">
<p>A template is available in the MediatRManagement folder of the <code>Devon4Net.Application.WebAPI.Implementation</code> Business Layer:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MediatR-management.png" alt="MediatR management">
</div>
<div class="title">Figure 110. MediatR Management Folder Structure</div>
</div>
<div class="paragraph">
<p>As we can see, this example adheres to the CQRS pattern structure, with Commands for writing methods and Queries for reading operations, as well as one handler for each method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CreateTodoCommand.cs</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> public class CreateTodoCommand : CommandBase&lt;TodoResultDto&gt;
    {
        public string Description { get; set; }

        public CreateTodoCommand(string description)
        {
            Description = description;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CreateTodoCommand inherits from <code>CommandBase&lt;T&gt;</code>, in this situation, the request message’s additional properties, such as <code>Description</code> of the <code>Todo</code> entity, will be included.</p>
</div>
</li>
<li>
<p><code>GetTodoQuery.cs</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class GetTodoQuery : QueryBase&lt;TodoResultDto&gt;
    {
        public long TodoId{ get; set; }

        public GetTodoQuery(long todoId)
        {
            TodoId = todoId;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because GetTodoQuery inherits from <code>QueryBase&lt;T&gt;</code>, an <code>TodoId</code> of the <code>Todo</code> object will be attached to the message’s properties in this case.</p>
</div>
</li>
<li>
<p><code>CreateTodoHandler.cs</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class CreateTodoHandler : MediatrRequestHandler&lt;CreateTodoCommand, TodoResultDto&gt;
    {
        private ITodoService TodoService { get; set; }

        public CreateTodoHandler(ITodoService todoService, IMediatRBackupService mediatRBackupService, IMediatRBackupLiteDbService mediatRBackupLiteDbService) : base(mediatRBackupService, mediatRBackupLiteDbService)
        {
            Setup(todoService);
        }

        public CreateTodoHandler(ITodoService todoService, IMediatRBackupLiteDbService mediatRBackupLiteDbService) : base(mediatRBackupLiteDbService)
        {
            Setup(todoService);
        }

        public CreateTodoHandler(ITodoService todoService, IMediatRBackupService mediatRBackupService) : base(mediatRBackupService)
        {
            Setup(todoService);
        }

        private void Setup(ITodoService todoService)
        {
            TodoService = todoService;
        }

        public override async Task&lt;TodoResultDto&gt; HandleAction(CreateTodoCommand request, CancellationToken cancellationToken)
        {

            var result = await TodoService.CreateTodo(request.Description).ConfigureAwait(false);

            return new TodoResultDto
            {
                Id = result.Id,
                Done = result.Done,
                Description = result.Description
            };

        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class must to inherit from <code>MediatrRequestHandler&lt;TRequest, TResponse&gt;</code> class that is explained above.
On first place we inject the TodoService via dependency injection using the <code>Setup(ITodoService todoService)</code> method, and then we overload the <code>HandleAction(TRequest request, CancellationToken cancellationToken)</code> method calling the service and returning the new DTO</p>
</div>
</li>
<li>
<p><code>GetTodoHandler.cs</code>:</p>
<div class="paragraph">
<p>All handlers may be configured using the same structure as <code>CreateTodoHandler.cs.</code> To do the required operation, just change the method called by the service.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_32">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package in your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">Install-Package Devon4Net.Infrastructure.MediatR</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a Configuration static class in order to add the <code>IRequestHandler</code> services, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> public static class Configuration
    {

        public static void SetupDependencyInjection(this IServiceCollection services, IConfiguration configuration)
        {

            var mediatR = serviceProvider.GetService&lt;IOptions&lt;MediatROptions&gt;&gt;();

            if (mediatR?.Value != null &amp;&amp; mediatR.Value.EnableMediatR)
            {
                SetupMediatRHandlers(services);
            }
        }

        private static void SetupMediatRHandlers(IServiceCollection services)
        {
            services.AddTransient(typeof(IRequestHandler&lt;GetTodoQuery, TodoResultDto&gt;), typeof(GetTodoHandler));
            services.AddTransient(typeof(IRequestHandler&lt;CreateTodoCommand, TodoResultDto&gt;), typeof(CreateTodoHandler));
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following lines in the <code>Program.cs</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupMediatR(builder.Configuration);
builder.Services.SetupDependencyInjection(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the default settings provided in the configuration section, you may use the MediatR component in your code.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.rabbitmq">Devon4Net.Infrastructure.RabbitMQ</h4>
<div class="paragraph">
<p><code>RabbitMQ</code> is an open-source message-broker software (also known as message-oriented middleware) that was developed to support the Advanced Message Queuing Protocol (AMQP) and has since been expanded with a plug-in architecture to support the Streaming Text Oriented Messaging Protocol (STOMP), MQ Telemetry Transport (MQTT), and <a href="https://www.rabbitmq.com/protocols.html">other protocols</a>.</p>
</div>
<div class="paragraph">
<p>In <code>RabbitMQ</code>, queues are defined to store messages sent by producers until they are received and processed by consumer applications.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_patterns_33">Patterns</h5>
<div class="ulist">
<ul>
<li>
<p>Publisher-Subscriber pattern</p>
<div class="paragraph">
<p>Publish-Subscribe is a design pattern that allows loose coupling between the application components.</p>
</div>
<div class="paragraph">
<p>Message senders, known as publishers, do not configure the messages to be sent directly to specific receivers, known as subscribers.
Messages are released with no information of what they are or if any subscribers to that information exist.
Delegate is the core of this C# design pattern.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/publish-suscribe.png" alt="publish suscribe">
</div>
<div class="title">Figure 111. RabbitMQ Queue system</div>
</div>
<div class="paragraph">
<p>To summarize :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A producer is a user application that sends messages.</p>
</li>
<li>
<p>A queue is a buffer that stores messages.</p>
</li>
<li>
<p>A consumer is a user application that receives messages.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_key-classes_34">Key Classes</h5>
<div class="paragraph">
<p>In the case of this component the messages are created in the <code>Message</code> abstract class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public abstract class Message
    {
        public string MessageType { get; }
        public Guid InternalMessageIdentifier { get; set; }

        protected Message()
        {
            MessageType = GetType().Name;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the <code>Command</code> serializable class inherits from <code>Message</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[Serializable]
public class Command : Message
    {
        public DateTime Timestamp { get; protected set; }
        protected Command()
        {
            Timestamp = DateTime.Now;
            InternalMessageIdentifier = Guid.NewGuid();
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The message will have from base a Timestamp, a Guid as message identifier and the message type.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_35">Configuration</h5>
<div class="paragraph">
<p>Component configuration is made on file <code>appsettings.{environment}.json</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  "RabbitMq": {
    "EnableRabbitMq": true,
    "Hosts": [
      {
        "Host": "127.0.0.1",
        "Port": 5672,
        "Ssl": false,
        "SslServerName": "localhost",
        "SslCertPath": "localhost.pfx",
        "SslCertPassPhrase": "localhost",
        "SslPolicyErrors": "RemoteCertificateNotAvailable" //None, RemoteCertificateNotAvailable, RemoteCertificateNameMismatch, RemoteCertificateChainErrors
      }
    ],

    "VirtualHost": "/",
    "UserName": "admin",
    "Password": "password",
    "Product": "devon4net",
    "RequestedHeartbeat": 10, //Set to zero for no heartbeat
    "PrefetchCount": 50,
    "PublisherConfirms": false,
    "PersistentMessages": true,
    "Platform": "localhost",
    "Timeout": 10,
    "Backup": {
      "UseLocalBackup": true,
      "DatabaseName": "devon4netMessageBackup.db"
    }
  },</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please refer to the <a href="https://github.com/EasyNetQ/EasyNetQ/wiki/Connecting-to-RabbitMQ">official EasyNetQ documentation</a> for further details about connection parameters.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_36">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template configure it in the <code>appsettings.{environment}.json</code> file.</p>
</div>
<div class="paragraph">
<p>A template is available in the RabbitMqManagement folder of the <code>Devon4Net.Application.WebAPI.Implementation</code> Business folder:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/RabbitMqManagement.png" alt="RabbitMqManagement">
</div>
<div class="title">Figure 112. RabbitMQ Management folder structure</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TodoCommand.cs</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> public class TodoCommand : Command
    {
        public string Description { get; set; }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>TodoCommand</code> inherits from <code>Command</code>, in this case, the <code>Description</code> will be added to the <code>Message</code>.</p>
</div>
</li>
<li>
<p><code>TodoRabbitMqHandler.cs</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> public class TodoRabbitMqHandler: RabbitMqHandler&lt;TodoCommand&gt;
    {
        private ITodoService TodoService { get; set; }

        public TodoRabbitMqHandler(IServiceCollection services, IBus serviceBus, bool subscribeToChannel = false) : base(services, serviceBus, subscribeToChannel)
        {
        }

        public TodoRabbitMqHandler(IServiceCollection services, IBus serviceBus, IRabbitMqBackupService rabbitMqBackupService, bool subscribeToChannel = false) : base(services, serviceBus, rabbitMqBackupService, subscribeToChannel)
        {
        }

        public TodoRabbitMqHandler(IServiceCollection services, IBus serviceBus, IRabbitMqBackupLiteDbService rabbitMqBackupLiteDbService, bool subscribeToChannel = false) : base(services, serviceBus, rabbitMqBackupLiteDbService, subscribeToChannel)
        {
        }

        public TodoRabbitMqHandler(IServiceCollection services, IBus serviceBus, IRabbitMqBackupService rabbitMqBackupService, IRabbitMqBackupLiteDbService rabbitMqBackupLiteDbService, bool subscribeToChannel = false) : base(services, serviceBus, rabbitMqBackupService, rabbitMqBackupLiteDbService, subscribeToChannel)
        {
        }

        public override async Task&lt;bool&gt; HandleCommand(TodoCommand command)
        {
            TodoService = GetInstance&lt;ITodoService&gt;();

            var result = await TodoService.CreateTodo(command.Description).ConfigureAwait(false);
            return result!=null;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class must to inherit from <code>RabbitMqHandler&lt;T&gt;</code> class.
<code>HandleCommand(T command)</code> method should be overridden in order to send command to the queue, this method returns true if the message has been published.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_37">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package in your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">Install-Package Devon4Net.Infrastructure.RabbitMQ</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a Configuration static class in order to add the <code>RabbitMqHandler</code> services, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> public static class Configuration
    {

        public static void SetupDependencyInjection(this IServiceCollection services, IConfiguration configuration)
        {

            var rabbitMq = serviceProvider.GetService&lt;IOptions&lt;RabbitMqOptions&gt;&gt;();

            if (rabbitMq?.Value != null &amp;&amp; rabbitMq.Value.EnableRabbitMq)
            {
                SetupRabbitHandlers(services);
            }
        }

        private static void SetupRabbitHandlers(IServiceCollection services)
        {
            services.AddRabbitMqHandler&lt;TodoRabbitMqHandler&gt;(true);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following lines in the <code>Program.cs</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupRabbitMq(builder.Configuration);
builder.Services.SetupDependencyInjection(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the default settings provided in the configuration section, you may use the RabbitMQ component in your code.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please see the <a href="https://www.rabbitmq.com/download.html"> RabbitMQ official documentation</a> for instructions on installing the RabbitMQ Server.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.middleware">Devon4Net.Infrastructure.Middleware</h4>
<div class="paragraph">
<p>Middleware is software that’s assembled into an app pipeline to handle requests and responses. Request delegates are used to construct the request pipeline. Each HTTP request is handled by a request delegate.</p>
</div>
<div class="paragraph">
<p>The diagram below represents the whole request processing pipeline for ASP.NET Core MVC and Razor Pages apps.
You can see how existing middlewares are organized in a typical app and where additional middlewares are implemented.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/middleware-life-cycle.png" alt="middleware life cycle">
</div>
<div class="title">Figure 113. Middleware Order</div>
</div>
<div class="paragraph">
<p>The ASP.NET Core request pipeline is composed of a number of request delegates that are called one after the other. This concept is illustrated in the diagram below. The execution thread is shown by the black arrows.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/middleware-delegates-flow.png" alt="middleware delegates flow">
</div>
<div class="title">Figure 114. Delegates flow in middleware</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_38">Configuration</h5>
<div class="paragraph">
<p>In this component there are four custom Middlewares classes, configuration is made on file <code>appsettings.{environment}.json</code> as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ClientCertificatesMiddleware.cs</code>: For the management of client certificates.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  "Certificates": {
    "ServerCertificate": {
      "Certificate": "",
      "CertificatePassword": ""
    },
    "ClientCertificate": {
      "EnableClientCertificateCheck": false,
      "RequireClientCertificate": false,
      "CheckCertificateRevocation": true,
      "ClientCertificates": {
        "Whitelist": [
          ""
        ]
      }
    }
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ClientCertificate Whitelist contains the client’s certificate thumbprint.</p>
</div>
</li>
<li>
<p><code>ExceptionHandlingMiddleware.cs</code>: Handles a few different types of exceptions.</p>
</li>
<li>
<p><code>CustomHeadersMiddleware.cs</code>: To add or remove certain response headers.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"Headers": {
    "AccessControlExposeHeader": "Authorization",
    "StrictTransportSecurityHeader": "",
    "XFrameOptionsHeader": "DENY",
    "XssProtectionHeader": "1;mode=block",
    "XContentTypeOptionsHeader": "nosniff",
    "ContentSecurityPolicyHeader": "",
    "PermittedCrossDomainPoliciesHeader": "",
    "ReferrerPolicyHeader": ""
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the sample above, the server application will add to the response headers the <code>AccessControlExposeHeader</code>, <code>XFrameOptionsHeader</code>, <code>XssProtectionHeader</code> and <code>XContentTypeOptionsHeader</code> headers.
If the header response attribute does not have a value, it will not be added to the response headers.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please refer to the <a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html">How To: Customize Headers</a> documentation for more information.
</td>
</tr>
</tbody></table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/headers-middleware.png" alt="headers middleware">
</div>
<div class="title">Figure 115. Response Headers</div>
</div>
</li>
<li>
<p><code>KillSwicthMiddleware.cs</code>: To enable or disable HTTP requests.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"KillSwitch": {
    "UseKillSwitch": false,
    "EnableRequests": true,
    "HttpStatusCode": 403
  },</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UseKillSwitch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True to enable KillSwtich middleware</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnableRequests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True to enable HTTP requests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HttpStatusCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the HTTP status code that will be returned</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_39">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure it in the appsettings.Development.json file.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_40">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Devon4Net.Infrastructure.Middleware</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure the component in <code>Program.cs</code> adding the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Infrastructure.Middleware.Middleware;
.
.
.
builder.Services.SetupMiddleware(builder.Configuration);
.
.
.
app.SetupMiddleware(builder.Services);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the default configuration shown in the configuration section.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_references_41">References</h5>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-6.0">ASP.NET Core Middleware - Microsoft Docs</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware/write?view=aspnetcore-6.0">Write custom ASP.NET Core middleware - Microsoft Docs</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_packages.asciidoc_devon4net.infrastructure.unitofwork">Devon4Net.Infrastructure.UnitOfWork</h4>
<div class="paragraph">
<p>The idea of Unit of Work is related to the successful implementation of the Repository Pattern. It is necessary to first comprehend the Repository Pattern in order to fully understand this concept.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_packages.asciidoc_the-repository-pattern">The Repository Pattern</h5>
<div class="paragraph">
<p>A repository is a class defined for an entity, that contains all of the operations that may be executed on that entity. For example, a repository for an entity Employee will contain basic CRUD operations as well as any additional potential actions connected to it. The following procedures can be used to implement the Repository Pattern:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One repository per entity (non-generic) : This approach makes use of a single repository class for each entity. For instance, if you have two entities, Todo and Employee, each will have its own repository.</p>
</li>
<li>
<p>Generic repository: A generic repository is one that can be used for all entities.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_packages.asciidoc_unit-of-work-in-the-repository-pattern">Unit of Work in the Repository Pattern</h6>
<div class="paragraph">
<p>Unit of Work is referred to as a single transaction that involves multiple operations of insert/update/delete. It means that, for a specific user action, all transactions are performed in a single transaction rather than several database transactions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Unit-of-work.png" alt="Unit of work">
</div>
<div class="title">Figure 116. Unit of work diagram</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_configuration_42">Configuration</h5>
<div class="paragraph">
<p>Connection strings must be added to the configuration in the file <code>appsettings.environment.json</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"ConnectionStrings": {
    "Todo": "Add your database connection string here",
    "Employee": "Add your database connection string here"
  },</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-devon_43">Setting up in Devon</h5>
<div class="paragraph">
<p>For setting it up using the Devon4NetApi template just configure the connection strings in the <code>appsettings.Development.json</code> file.</p>
</div>
<div class="paragraph">
<p>To add Databases, use the SetupDatabase method in the <code>DevonConfiguration.cs</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">  private static void SetupDatabase(IServiceCollection services, IConfiguration configuration)
        {
            services.SetupDatabase&lt;TodoContext&gt;(configuration, "Todo", DatabaseType.SqlServer, migrate:true).ConfigureAwait(false);
            services.SetupDatabase&lt;EmployeeContext&gt;(configuration, "Employee", DatabaseType.SqlServer, migrate:true).ConfigureAwait(false);
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must provide the configuration, the connection string key, and the database type.</p>
</div>
<div class="paragraph">
<p>The supported databases are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SqlServer</p>
</li>
<li>
<p>Sqlite</p>
</li>
<li>
<p>InMemory</p>
</li>
<li>
<p>Cosmos</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>MySql</p>
</li>
<li>
<p>MariaDb</p>
</li>
<li>
<p>FireBird</p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>MSAccess</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Set the migrate property value to true if you need to use migrations, as shown above.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information about the use of migrations please visit the <a href="https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations/?tabs=dotnet-core-cli">official microsoft documentation</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Our typed repositories must inherit from the generic repository of the Unit Of Work component, as seen in the example below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">  public class TodoRepository : Repository&lt;Todos&gt;, ITodoRepository
    {
        public TodoRepository(TodoContext context) : base(context)
        {

        }
        .
        .
        .
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the methods of the generic repository to perform your CRUD actions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public Task&lt;Todos&gt; Create(string description)
        {

            var todo = new Todos {Description = description};
            return Create(todo);
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default value for <code>AutoSaveChanges</code> to the Database is true, you may change it to false if you need to employ transactions.</p>
</div>
<div class="paragraph">
<p>Inject the Repository on the service of the business layer, as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class TodoService: Service&lt;TodoContext&gt;, ITodoService
    {
        private readonly ITodoRepository _todoRepository;

        public TodoService(IUnitOfWork&lt;TodoContext&gt; uoW) : base(uoW)
        {
            _todoRepository = uoW.Repository&lt;ITodoRepository&gt;();
        }
        .
        .
        .
    }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_setting-up-in-other-projects_44">Setting up in other projects</h5>
<div class="paragraph">
<p>Install the package on your solution using the Package Manager Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Devon4Net.Infrastructure.UnitOfWork</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a Configuration static class in order to add the <code>IRequestHandler</code> services, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public static class Configuration
    {
        public static void SetupDependencyInjection(this IServiceCollection services, IConfiguration configuration)
        {
            SetupDatabase(services, configuration);
        }

        private static void SetupDatabase(IServiceCollection services, IConfiguration configuration)
        {
            services.SetupDatabase&lt;TodoContext&gt;(configuration, "Default", DatabaseType.SqlServer).ConfigureAwait(false);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure the component in <code>Program.cs</code> adding the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Domain.UnitOfWork;
.
.
.
builder.Services.SetupUnitOfWork(typeof(Configuration));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the default configuration shown in the configuration section and follow the same steps as the previous section.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_packages.asciidoc_tips_45">Tips</h5>
<div class="paragraph">
<p><em>Predicate expression builder</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use this expression builder to generate lambda expressions dynamically:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">var predicate =  PredicateBuilder.True&lt;T&gt;();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>T</code> is a class. At this moment, you can build your expression and apply it to obtain your results in a efficient way and not retrieving data each time you apply an expression.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example from My Thai Star .Net Core implementation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-C#" data-lang="C#">public async Task&lt;PaginationResult&lt;Dish&gt;&gt; GetpagedDishListFromFilter(int currentpage, int pageSize, bool isFav, decimal maxPrice, int minLikes, string searchBy, IList&lt;long&gt; categoryIdList, long userId)
{
    var includeList = new List&lt;string&gt;{"DishCategory","DishCategory.IdCategoryNavigation", "DishIngredient","DishIngredient.IdIngredientNavigation","IdImageNavigation"};

    //Here we create our predicate builder
    var dishPredicate = PredicateBuilder.True&lt;Dish&gt;();


    //Now we start applying the different criteria:
    if (!string.IsNullOrEmpty(searchBy))
    {
        var criteria = searchBy.ToLower();
        dishPredicate = dishPredicate.And(d =&gt; d.Name.ToLower().Contains(criteria) || d.Description.ToLower().Contains(criteria));
    }

    if (maxPrice &gt; 0) dishPredicate = dishPredicate.And(d=&gt;d.Price&lt;=maxPrice);

    if (categoryIdList.Any())
    {
        dishPredicate = dishPredicate.And(r =&gt; r.DishCategory.Any(a =&gt; categoryIdList.Contains(a.IdCategory)));
    }

    if (isFav &amp;&amp; userId &gt;= 0)
    {
        var favourites = await UoW.Repository&lt;UserFavourite&gt;().GetAllAsync(w=&gt;w.IdUser == userId);
        var dishes = favourites.Select(s =&gt; s.IdDish);
        dishPredicate = dishPredicate.And(r=&gt; dishes.Contains(r.Id));
    }

    // Now we can use the predicate to retrieve data from database with just one call
    return await UoW.Repository&lt;Dish&gt;().GetAllIncludePagedAsync(currentpage, pageSize, includeList, dishPredicate);

}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>↑&nbsp;Up:&nbsp;<a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_packages.html">Packages</a>&nbsp;| ⌂&nbsp;Home:&nbsp;<a href="master.html">devonfw guide</a>&nbsp;| Next:&nbsp;<a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_templates.html">Templates</a>&nbsp;→</p>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/welcome/welcome.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_introduction-why-should-i-use-devonfw.asciidoc_features.html">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html#devonfw-guide_devon4j.wiki_architecture.asciidoc_technology-stack#">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_ide.wiki_devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_general_master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script src="/website/assets/scripts/popper.min.js"></script>
    <script src="/website/assets/scripts/bootstrap.min.js"></script>
<div class="footnote"><sub>

Last updated 2022-06-16 10:27:14 UTC
</sub></div>


<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script async="" src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
<script>
      let cookieName = 'cookie_consent';
      let expiryTime = new Date(2037, 11, 21);
      let today = new Date();
      let cookieConsentDeclinedDate = localStorage.getItem("cookie_consent_declined");
      let dateDiffHours = 0;
      let cookieConsentHtml = `
      <div id="cookie-consent">
        <p>
          We use cookies to perform analytics and enhance user experience. Do you accept to the use of cookies?
        </p>
        <p class="cookie-consent-buttons">
          <a id="decline-cookie-btn" class="btn white-button" href="javascript:void(0)">Decline</a>
          <a id="accept-cookie-btn" class="btn blue-button" href="javascript:void(0)">Accept</a>
        </p>
      </div>
      `;
      dateDiffHours = cookieConsentDeclinedDate ? Math.abs(cookieConsentDeclinedDate - today) / 36e5 : 0;
      if (document.cookie.indexOf(cookieName) < 0) {
        if (cookieConsentDeclinedDate) {
          if (dateDiffHours > 24) {
            $("body").append(cookieConsentHtml);
          }
        } else {
          $("body").append(cookieConsentHtml);
        }
      }
      $("#accept-cookie-btn").click(function() {
        document.cookie = `${cookieName}=accept;expires=${expiryTime};path=/`;
        localStorage.removeItem("cookie_consent_declined");
        consentGranted();
        $("#cookie-consent").hide();
      });
      $("#decline-cookie-btn").click(function() {
        localStorage.setItem("cookie_consent_declined", today);
        $("#cookie-consent").hide();
      });
</script>

</body></html>