<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>Initialize Instance Template for Production Line</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Ubuntu Font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400&display=swap" rel="stylesheet">
<!-- Lunr -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" integrity="sha256-M/Awbb/BYh+Rh0aGjpQid26p1b2OBsrk2k9yAvQxPV0=" crossorigin="anonymous"></script>
<!-- JQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.4/styles/googlecode.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.4/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.4/lang/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<!-- ************** Google analytics ************ -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>

<!-- ******************************************** -->


<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
</head>
<body class="article">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt=""/>
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="/website/pages/welcome/welcome.html"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">DOCS</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input
      id="search-field"
      type="search"
      class="form-control mr-sm-2"
      placeholder="Search by keyword(s)..."
      aria-label="Search"
      style="height: auto;"
      autocomplete="off"/>
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width=auto height=auto alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="content" class="mt-4 mt-sm-5">
<div class="toc2">
<div class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#initialize-instance.asciidoc">Initialize Instance Template for Production Line</a>
<ul class="sectlevel1">
<li><a href="#initialize-instance.asciidoc_introduction">Introduction</a></li>
<li><a href="#initialize-instance.asciidoc_prerequisites">Prerequisites</a></li>
<li><a href="#initialize-instance.asciidoc_template">Template</a>
<ul class="sectlevel2">
<li><a href="#initialize-instance.asciidoc_parameters">Parameters</a></li>
<li><a href="#initialize-instance.asciidoc_execution">Execution</a></li>
<li><a href="#initialize-instance.asciidoc_the-result">The result</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="initialize-instance.asciidoc" class="sect0">Initialize Instance Template for Production Line</h1>
<div class="sect1">
<h2 id="initialize-instance.asciidoc_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Production Line Templates allows you to create/configure certain task. In order to work properly, Production Line Templates needs some previous configurations. You can do it <a href="#initialize-instance-manually.asciidoc">manually</a> or executing the Initialize Instance Template.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="initialize-instance.asciidoc_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to be able to start this template, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/devonfw/production-line-shared-lib">Production Line Shared Lib</a> added in Jenkins</p>
</li>
<li>
<p>The following plugins:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Custom+Tools+Plugin">Custom Tools Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/HTTP+Request+Plugin">HTTP Request Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Job+DSL+Plugin">Job DSL Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/SonarQube+plugin">SonarQube plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Pipeline+Maven+Plugin">Pipeline Maven Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/NodeJS+Plugin">NodeJS Plugin</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>A service account added in the LAM</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Production Line provides by default the Shared Lib and the plugins, so no actions are required. The only thing that you need to do manually is the creation of the service account.</p>
</div>
<div class="paragraph">
<p>In order to create the service account you need:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the LAM</p>
</li>
<li>
<p>Press the <code>New User</code> button</p>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/create-account.png" alt="create account">
</div>
</div>
</li>
<li>
<p>Enter the required parameters</p>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/create-account2.png" alt="create account2">
</div>
</div>
</li>
<li>
<p>Change to <code>Unix</code> tab and enter the required parameters</p>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/create-account3.png" alt="create account3">
</div>
</div>
<div class="paragraph">
<p>The user name will be used later in order to login. As this user will do some configuration changes, its primary group must be admins.</p>
</div>
</li>
<li>
<p>Set a password for the user.</p>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/create-account4.png" alt="create account4">
</div>
</div>
</li>
<li>
<p>Press the <code>Save</code> button</p>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/create-account5.png" alt="create account5">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="initialize-instance.asciidoc_template">Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to execute this template, you need to add it into Jenkins manually. In order to do that, you can follow <a href="#how-to-add-a-template.asciidoc">this guide</a></p>
</div>
<div class="sect2">
<h3 id="initialize-instance.asciidoc_parameters">Parameters</h3>
<div class="paragraph">
<p>The required parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>svcaccount</code>: The service account created as prerequisite. It must be added as a Jenkins credential.</p>
</li>
<li>
<p><code>installDeploymentPlugins</code>: With this parameter you can install extra plugins into Jenkins. Also, you can add extra template utils.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="initialize-instance.asciidoc_execution">Execution</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Press the Build with Parameters button</p>
</li>
<li>
<p>Insert the parameters.</p>
</li>
<li>
<p>If the service account is not added as credential, please add a new entry.</p>
</li>
<li>
<p>Press the <code>Build</code> button.</p>
</li>
<li>
<p>Wait until the pipeline ends.</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="icon-warning" title=""></i>
</td>
<td class="content">
if any plugin is installed, Jenkins will be restarted and the pipeline will fail. You need to execute it again with the same parameters.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/initialize-instance.png" alt="initialize instance">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/initialize-instance2.png" alt="initialize instance2">
</div>
</div>
</div>
<div class="sect2">
<h3 id="initialize-instance.asciidoc_the-result">The result</h3>
<div class="ulist">
<ul>
<li>
<p>Install plugins stage</p>
<div class="paragraph">
<p>In this stage the following plugins will be installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/SSH+Credentials+Plugin">SSH Credentials Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Custom+Tools+Plugin">Custom Tools Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/HTTP+Request+Plugin">HTTP Request Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Job+DSL+Plugin">Job DSL Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/SonarQube+plugin">SonarQube plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin">Ansible Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Pipeline+Maven+Plugin">Pipeline Maven Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/NodeJS+Plugin">NodeJS Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/GitLab+Plugin">GitLab Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/OWASP+Dependency-Check+Plugin">OWASP Dependency-Check Plugin</a></p>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Docker</code> or <code>Docker+Openshift</code>, extra plugins will be installed:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Docker+Plugin">Docker Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Docker+build+step+plugin">Docker build step plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Docker+Pipeline+Plugin">Docker Pipeline Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/JClouds+Plugin">JClouds Plugin</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Openshift</code> or <code>Docker+Openshift</code>, extra plugins will be installed:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/OpenShift+Client+Plugin">OpenShift Client Plugin</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Configure SonarQube stage</p>
<div class="paragraph">
<p>This stage is the responsible of configure the Jenkins-SonarQube integration. It will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generate a SonarQube API token for the user <code>Admin</code></p>
</li>
<li>
<p>Register the token in Jenkins as credential with the id <code>sonar-token</code></p>
</li>
<li>
<p>Add the SonarQube server in Jenkins &#8594; Manage Jenkins &#8594; Configure System &#8594; SonarQube servers. The values used are:</p>
<div class="ulist">
<ul>
<li>
<p>Name: <code>SonarQube</code></p>
</li>
<li>
<p>Server URL: <a href="http://sonarqube-core:9000/sonarqube" class="bare">http://sonarqube-core:9000/sonarqube</a> (default Production Line SonarQube URL)</p>
</li>
<li>
<p>Server authentication token: <code>sonar-token</code> (generated in the previous step)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add a webhook in SonarQube:</p>
<div class="ulist">
<ul>
<li>
<p>Name: <code>jenkins</code></p>
</li>
<li>
<p>URL: <code><a href="http://jenkins-core:8080/jenkins/sonarqube-webhook/" class="bare">http://jenkins-core:8080/jenkins/sonarqube-webhook/</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Install the following SonarQube plugins:</p>
<div class="ulist">
<ul>
<li>
<p>java</p>
</li>
<li>
<p>javascript</p>
</li>
<li>
<p>typescript</p>
</li>
<li>
<p>csharp</p>
</li>
<li>
<p>web</p>
</li>
<li>
<p>cssfamily</p>
</li>
<li>
<p>jacoco</p>
</li>
<li>
<p>checkstyle</p>
</li>
<li>
<p>cobertura</p>
</li>
<li>
<p>smells</p>
</li>
<li>
<p>findbugs</p>
</li>
<li>
<p>scmgit</p>
</li>
<li>
<p>ansible</p>
</li>
<li>
<p>sonar-dependency-check-plugin</p>
</li>
</ul>
</div>
</li>
<li>
<p>Restart the SonarQube server in order to enable the plugins installed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create UTIL templates stage</p>
<div class="paragraph">
<p>Some templates needs that Jenkins has installed some plugins. If the plugins are not installed, the template will fail. In order to prevent this behaviour, we use the <code>initialize-instance</code> to install all plugins required in order templates. Then, we create another templates that will use the plugins installed by <code>initialize-instance</code>. In this stage we create some template utils to configure Jenkins after all required plugins are installed. Those templates are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#install-sonar-plugin.asciidoc">Install_SonarQube_Plugin</a></p>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Docker</code> or <code>Docker+Openshift</code>: <a href="#docker-configuration.asciidoc">Docker_Configuration</a></p>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Openshift</code> or <code>Docker+Openshift</code>: <a href="#openshift-configuration.asciidoc">Openshift_Configuration</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure Nexus 3 stage</p>
<div class="paragraph">
<p>This stage will configure the Production Line Nexus3</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enable anonymous access</p>
</li>
<li>
<p>Add a internal user to download/upload docker images</p>
<div class="ulist">
<ul>
<li>
<p>username: <code>nexus-api</code></p>
</li>
<li>
<p>password: The same as the service account created in LAM</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create the maven repositories: maven-central, maven-snapshots, maven-release, maven-plugin</p>
</li>
<li>
<p>Create the docker repository</p>
</li>
<li>
<p>Create the npmjs repositories: npmjs, npm-registry, npm</p>
</li>
<li>
<p>Create in Jenkins a new credential with the id <code>nexus-api</code> with the username and password created in nexus3</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure Maven File stage</p>
<div class="paragraph">
<p>This stage adds the nexus3 credentials created in the previous stage to the maven global configuration file with the id <code>pl-nexus</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="/home/runner/work/devonfw.github.io/devonfw.github.io/target/generated-docs/images/initialize-instance/maven-config.png" alt="maven config">
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, you are able to execute other templates adding them manually or using the Production Line Market Place.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc_introduction.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc_introduction.html#introduction-why-should-i-use-devonfw.asciidoc">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc_further-information.html">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
<li>
<p><a href="/website/pages/resources/resources.html">Resources</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-ide-support.asciidoc.html#LICENSE.asciidoc">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
<div class="footnote"><sub>

Last updated 2021-12-15 07:10:54 UTC
</sub></div>
</div>
</div>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
</body>
</html>